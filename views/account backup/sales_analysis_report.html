<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>รายงานวิเคราะห์การขาย</title>

  <!-- Google Font -->
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&display=swap" rel="stylesheet" />

  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" />

  <!-- Required Libraries for Export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <!-- Add Thai calendar locale -->
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1.10.7/dayjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1.10.7/locale/th.js"></script>

  <script>
    tailwind.config = {
      darkMode: 'class'
      theme: {
        extend: {
          fontFamily: {
            sans: ['Prompt', 'sans-serif'],'
          },
          colors: {
            primary: {
              50: '#f0f9ff','
              100: '#e0f2fe','
              500: '#0ea5e9','
              600: '#0284c7','
            }
          }
        },
      }
    }
  </script>

  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow-x: hidden;
    }
    body {
      display: flex;
      flex-direction: column;
    }
    #mainContent {
      flex: 1;
    }
    
    body {
      font-family: 'Prompt', sans-serif;'
      font-size: 0.875rem;
      background-color: #f8f9fa;
    }
    
    .dark body {
      background-color: #1a202c;
      color: #f8f9fa;
    }
    
    .breadcrumb-item {
      color: #6c757d;
    }
    
    .breadcrumb-item a {
      color: #0ea5e9;
      text-decoration: none;
    }
    
    .breadcrumb-item a:hover {
      text-decoration: underline;
    }
    
    .card {
      background-color: white;
      border-radius: 4px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    .dark .card {
      background-color: #2d3748;
      border-color: #4a5568;
    }
    
    .form-control {
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 8px 12px;
      width: 100%;
    }
    
    .dark .form-control {
      background-color: #2d3748;
      border-color: #4a5568;
      color: #f8f9fa;
    }
    
    .btn {
      border-radius: 4px;
      padding: 8px 16px;
      transition: all 0.2s;
    }
    
    .btn-rounded {
      border-radius: 30px;
    }
    
    .btn-outline-primary {
      border: 1px solid #0ea5e9;
      color: #0ea5e9;
      background-color: white;
    }
    
    .btn-outline-primary:hover {
      background-color: #f0f9ff;
    }
    
    .dark .btn-outline-primary {
      color: #38bdf8;
      border-color: #38bdf8;
      background-color: transparent;
    }
    
    .dark .btn-outline-primary:hover {
      background-color: rgba(56, 189, 248, 0.1);
    }
    
    .table {
      width: 100%;
      border-collapse: collapse;
    }
    
    .table th {
      background-color: #f8f9fa;
      text-align: left;
      padding: 10px;
      color: #6c757d;
      font-weight: 500;
      border-bottom: 1px solid #eee;
    }
    
    .dark .table th {
      background-color: #2d3748;
      color: #d1d5db;
      border-bottom-color: #4a5568;
    }
    
    .table td {
      padding: 10px;
      border-bottom: 1px solid #eee;
      color: #333;
    }
    
    .dark .table td {
      border-bottom-color: #4a5568;
      color: #f8f9fa;
    }
    
    .text-right {
      text-align: right;
    }
    
    .page-link {
      min-width: 36px;
      height: 36px;
      border: 1px solid #ddd;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #555;
      text-decoration: none;
      margin: 0 2px;
    }
    
    .dark .page-link {
      border-color: #4a5568;
      color: #d1d5db;
    }
    
    .page-link:hover {
      background-color: #f9f9fb;
    }
    
    .dark .page-link:hover {
      background-color: #374151;
    }
    
    .page-link.active {
      background-color: #0ea5e9;
      color: white;
      border-color: #0ea5e9;
    }
    
    .dropdown-select {
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      background-color: white;
      color: #333;
    }
    
    .dark .dropdown-select {
      background-color: #2d3748;
      border-color: #4a5568;
      color: #f8f9fa;
    }
    
    .account-list {
      list-style: none;
      padding: 0;
      margin: 0;
      max-height: 400px;
      overflow-y: auto;
    }
    
    .account-list li {
      padding: 10px 15px;
      border-bottom: 1px solid #eee;
      cursor: pointer;
    }
    
    .dark .account-list li {
      border-bottom-color: #4a5568;
    }
    
    .account-list li:hover {
      background-color: #f9f9fb;
    }
    
    .dark .account-list li:hover {
      background-color: #374151;
    }
    
    .account-list li.active {
      background-color: #f0f9ff;
      color: #0ea5e9;
      font-weight: 500;
    }
    
    .dark .account-list li.active {
      background-color: #1a4971;
      color: #38bdf8;
    }
    
    .date-range {
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      cursor: pointer;
      background-color: white;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .dark .date-range {
      background-color: #2d3748;
      border-color: #4a5568;
      color: #f8f9fa;
    }
    
    .date-range:focus {
      border-color: #0ea5e9;
      outline: none;
    }
    
    .negative-value {
      color: #ef4444;
    }
    
    .dark .negative-value {
      color: #f87171;
    }
    
    .navbar {
      display: flex;
      align-items: center;
      padding: 0.5rem 1rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 30; /* Lowered z-index for navbar if menu dropdowns need to be higher */
    }
    
    .dark .navbar {
      background-color: #1e293b;
      box-shadow: 0 2px 4px rgba(0,0,0,0.4);
    }
    
    .flex-1 {
      flex: 1;
    }
    
    .flex-none {
      flex: none;
    }
    
    .btn-fancy {
      position: relative;
      overflow: hidden;
      transform: translate3d(0, 0, 0);
    }
    
    .btn-fancy:after {
      content: "";
      display: block;
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      pointer-events: none;
      background-image: radial-gradient(circle, #fff 10%, transparent 10.01%);
      background-repeat: no-repeat;
      background-position: 50%;
      transform: scale(10, 10);
      opacity: 0;
      transition: transform 0.5s, opacity 1s;
    }
    
    .btn-fancy:active:after {
      transform: scale(0, 0);
      opacity: 0.3;
      transition: 0s;
    }
    
    /* Dropdown menu styling */
    .menu {
      list-style: none;
      padding: 0;
      margin: 0;
      display: flex;
    }
    
    .menu-horizontal {
      display: flex;
      flex-direction: row;
    }
    
    .dropdown {
      position: relative;
    }
    
    .dropdown > a { /* Main category link */
      display: flex;
      padding: 0.5rem 1rem; /* Adjust as needed */
      cursor: pointer;
      align-items: center; /* Vertically align icon and text */
    }
    
    /* First Level Dropdown Panel */
    .dropdown > ul {
      position: absolute;
      top: 100%;
      left: 0;
      background: white; /* From Tailwind: bg-base-100 */
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); /* From Tailwind: shadow-lg */
      border-radius: 0.375rem; /* From Tailwind: rounded-lg */
      min-width: 220px;
      opacity: 0;
      visibility: hidden;
      transform: translateY(10px);
      transition: opacity 0.2s ease-out, visibility 0.2s ease-out, transform 0.2s ease-out;
      z-index: 40; /* Ensure dropdown is above other content but below higher-level modals if any */
      padding: 0.5rem; /* From Tailwind: p-2 */
    }
    
    .dark .dropdown > ul {
      background-color: #1e293b; /* From Tailwind: dark:bg-gray-700 or dark:bg-gray-800 */
    }
    
    .dropdown:hover > ul,
    .dropdown:focus-within > ul {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }
    
    /* Nested Dropdown Panels (Fly-out) */
    .dropdown ul li.dropdown > ul { /* Target UL inside an LI that is also a .dropdown */
      position: absolute;
      top: -0.5rem; /* Adjust to align with parent li, considering parent ul padding */
      left: 100%;
      /* Inherit background, shadow, radius, min-width, padding from first-level or define specifically */
      background: white; 
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      border-radius: 0.375rem;
      min-width: 220px; /* Or adjust as needed */
      opacity: 0;
      visibility: hidden;
      transform: translateX(10px); /* Fly-out from right */
      transition: opacity 0.2s ease-out, visibility 0.2s ease-out, transform 0.2s ease-out;
      z-index: 45; /* Higher than first-level dropdown */
      padding: 0.5rem;
    }
    
    .dark .dropdown ul li.dropdown > ul {
      background-color: #1e293b;
    }
    
    .dropdown ul li.dropdown:hover > ul,
    .dropdown ul li.dropdown:focus-within > ul {
      opacity: 1;
      visibility: visible;
      transform: translateX(0);
    }

    .dropdown ul li {
      list-style: none;
    }
    
    .dropdown ul li a { /* Styling for all links within dropdowns */
      display: flex; /* Use flex for alignment of icon and text */
      align-items: center;
      padding: 0.5rem 1rem; /* Tailwind: px-4 py-2 */
      color: #374151; /* Tailwind: text-gray-700 */
      text-decoration: none;
      border-radius: 0.25rem; /* Tailwind: rounded-md */
      white-space: nowrap; /* Prevent text wrapping in menu items */
    }
    
    .dark .dropdown ul li a {
      color: #d1d5db; /* Tailwind: dark:text-gray-200 */
    }
    
    .dropdown ul li a:hover {
      background-color: #f3f4f6; /* Tailwind: hover:bg-gray-100 */
    }
    
    .dark .dropdown ul li a:hover {
      background-color: #374151; /* Tailwind: dark:hover:bg-gray-600 */
    }

    /* Specific for an LI that is a dropdown trigger within another dropdown */
    .dropdown ul li.dropdown > a {
      justify-content: space-between; /* Puts arrow icon to the right */
    }
    
    .submenu-item { /* General styling for submenu items, including hover effect */
      transition: background-color 0.2s, padding-left 0.2s;
      border-left: 3px solid transparent;
      margin-bottom: 2px; /* Spacing between items */
    }
    
    .submenu-item:hover { /* Visual cue on hover */
      /* border-left-color: #0ea5e9; */ /* Original style, can be kept or removed */
      /* padding-left: 0.25rem; */ /* Original style, can be kept or removed */
    }
    
    /* User badge */
    .user-badge {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      background-color: rgba(14, 165, 233, 0.1);
      border-radius: 30px;
    }
    
    .user-avatar {
      background-color: #0ea5e9;
      color: white;
      height: 30px;
      width: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 500;
    }
    
    .dark .user-avatar {
      background-color: #38bdf8;
      color: #1a202c;
    }
    
    /* Loader */
    .loader {
      border: 3px solid #f3f3f3;
      border-top: 3px solid #0ea5e9;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      animation: spin 1s linear infinite;
      display: inline-block;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .expense-voucher {
      margin-left: 20px;
      position: relative;
    }
    
    .expense-voucher::before {
      content: '';'
      position: absolute;
      left: -15px;
      top: 50%;
      width: 10px;
      height: 1px;
      background-color: #cbd5e0;
    }
    
    .dark .expense-voucher::before {
      background-color: #4a5568;
    }
    
    /* Income Statement specific styles */
    .fin-statement-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
    }
    
    .fin-statement-table td {
      padding: 10px 16px;
      vertical-align: middle;
      border-bottom: 1px solid #e5e7eb;
    }
    
    .dark .fin-statement-table td {
      border-bottom-color: #374151;
    }
    
    .fin-statement-table .item-title {
      font-weight: 500;
    }
    
    .fin-statement-table .bold {
      font-weight: 600;
    }
    
    .fin-statement-table .section-header {
      font-weight: 600;
      font-size: 1.05rem;
      color: #111827;
    }
    
    .dark .fin-statement-table .section-header {
      color: #f9fafb;
    }
    
    .fin-statement-table .section-total {
      font-weight: 600;
      color: #1e40af;
      background-color: #f0f9ff;
    }
    
    .dark .fin-statement-table .section-total {
      color: #93c5fd;
      background-color: #1e3a8a;
    }
    
    .fin-statement-table .grand-total {
      font-weight: 700;
      color: #0284c7;
      background-color: #e0f2fe;
      font-size: 1.05rem;
    }
    
    .dark .fin-statement-table .grand-total {
      color: #38bdf8;
      background-color: #075985;
    }
    
    .fin-statement-table .indent-1 {
      padding-left: 2rem;
    }
    
    .fin-statement-table .indent-2 {
      padding-left: 3.5rem;
    }
    
    .overview-card {
      border-radius: 12px;
      padding: 1.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      background-color: white;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    .dark .overview-card {
      background-color: #1e293b;
    }
    
    .overview-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }
    
    .metric-label {
      font-size: 0.875rem;
      font-weight: 500;
      color: #6b7280;
      margin-bottom: 0.5rem;
    }
    
    .dark .metric-label {
      color: #9ca3af;
    }
    
    .metric-value {
      font-size: 1.5rem;
      font-weight: 600;
      color: #111827;
    }
    
    .dark .metric-value {
      color: #f9fafb;
    }
    
    .trend-up {
      color: #10b981;
    }
    
    .trend-down {
      color: #ef4444;
    }
    
    .dark .trend-up {
      color: #34d399;
    }
    
    .dark .trend-down {
      color: #f87171;
    }
    
    .chart-container {
      height: 300px;
      position: relative;
    }
    
    .view-switcher {
      display: flex;
      padding: 0.25rem;
      background-color: #f3f4f6;
      border-radius: 0.5rem;
      margin-bottom: 1.5rem;
    }
    
    .dark .view-switcher {
      background-color: #374151;
    }
    
    .view-option {
      flex: 1;
      text-align: center;
      padding: 0.5rem 1rem;
      cursor: pointer;
      border-radius: 0.375rem;
      font-weight: 500;
      transition: all 0.2s;
    }
    
    .view-option.active {
      background-color: white;
      color: #0ea5e9;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .dark .view-option.active {
      background-color: #1f2937;
      color: #38bdf8;
    }
    
    .action-button {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      font-size: 0.875rem;
      font-weight: 500;
      border-radius: 0.375rem;
      border: 1px solid #e5e7eb;
      background-color: white;
      color: #374151;
      transition: all 0.2s;
    }
    
    .dark .action-button {
      background-color: #1f2937;
      border-color: #4b5563;
      color: #e5e7eb;
    }
    
    .action-button:hover {
      background-color: #f9fafb;
      border-color: #d1d5db;
    }
    
    .dark .action-button:hover {
      background-color: #374151;
      border-color: #6b7280;
    }
    
    .period-selector {
      padding: 0.5rem;
      border: 1px solid #e5e7eb;
      border-radius: 0.375rem;
      background-color: white;
      font-size: 0.875rem;
      color: #374151;
      outline: none;
    }
    
    .dark .period-selector {
      background-color: #1f2937;
      border-color: #4b5563;
      color: #e5e7eb;
    }
    
    /* Dashboard Card Styles */
    .dashboard-cards {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .dashboard-card {
      background-color: white;
      border-radius: 0.75rem;
      padding: 1.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
    }
    
    .dark .dashboard-card {
      background-color: #1e293b;
    }
    
    .dashboard-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }
    
    .card-title {
      color: #6b7280;
      font-size: 0.875rem;
      font-weight: 500;
      margin-bottom: 0.5rem;
    }
    
    .dark .card-title {
      color: #9ca3af;
    }
    
    .card-value {
      font-size: 1.5rem;
      font-weight: 600;
      color: #111827;
      margin-bottom: 0.5rem;
    }
    
    .dark .card-value {
      color: #f9fafb;
    }
    
    .comparison-value {
      font-size: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }
    
    .comparison-up {
      color: #10b981;
    }
    
    .comparison-down {
      color: #ef4444;
    }
    
    .dark .comparison-up {
      color: #34d399;
    }
    
    .dark .comparison-down {
      color: #f87171;
    }
    
    /* Menu bar styles */
    .menu-bar {
      display: flex;
      background-color: white;
      border-radius: 0.5rem;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      margin-bottom: 1.5rem;
      overflow-x: auto;
    }
    
    .dark .menu-bar {
      background-color: #1e293b;
    }
    
    .menu-item {
      padding: 0.75rem 1.25rem;
      white-space: nowrap;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      border-bottom: 2px solid transparent;
      transition: all 0.2s;
    }
    
    .menu-item:hover {
      background-color: #f3f4f6;
      color: #0ea5e9;
    }
    
    .dark .menu-item:hover {
      background-color: #334155;
    }
    
    .menu-item.active {
      border-bottom-color: #0ea5e9;
      color: #0ea5e9;
      font-weight: 500;
    }
    
    .menu-spacer {
      flex: 1;
    }
    
    .month-selector {
      border: 1px solid #e5e7eb;
      border-radius: 0.375rem;
      padding: 0.25rem 0.5rem;
      background-color: white;
      font-size: 0.875rem;
      outline: none;
    }
    
    .dark .month-selector {
      background-color: #1f2937;
      border-color: #4b5563;
      color: #e5e7eb;
    }
    
    /* Display toggle */
    .display-toggle {
      display: flex;
      background-color: #f3f4f6;
      border-radius: 0.5rem;
      margin-bottom: 1.5rem;
      padding: 0.25rem;
    }
    
    .dark .display-toggle {
      background-color: #334155;
    }
    
    .toggle-btn {
      flex: 1;
      text-align: center;
      padding: 0.5rem 1rem;
      cursor: pointer;
      border-radius: 0.375rem;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }
    
    .toggle-btn.active {
      background-color: white;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      color: #0ea5e9;
    }
    
    .dark .toggle-btn.active {
      background-color: #1f2937;
    }
    
    /* Financial table */
    .view-container {
      background-color: white;
      border-radius: 0.5rem;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
    }
    
    .dark .view-container {
      background-color: #1e293b;
    }
    
    .hidden {
      display: none;
    }
    
    .financial-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
    }
    
    .financial-table th {
      background-color: #f8f9fa;
      color: #6b7280;
      font-weight: 500;
      text-align: left;
      padding: 0.75rem 1rem;
      border-bottom: 1px solid #e5e7eb;
    }
    
    .dark .financial-table th {
      background-color: #1f2937;
      color: #d1d5db;
      border-bottom-color: #4b5563;
    }
    
    .financial-table td {
      padding: 0.75rem 1rem;
      border-bottom: 1px solid #e5e7eb;
    }
    
    .dark .financial-table td {
      border-bottom-color: #4b5563;
    }
    
    .financial-table .section-header {
      font-weight: 600;
      background-color: #f3f4f6;
      color: #111827;
      padding: 0.75rem 1rem;
    }
    
    .dark .financial-table .section-header {
      background-color: #374151;
      color: #f3f4f6;
    }
    
    .financial-table .subsection-header {
      font-weight: 500;
      color: #4b5563;
      padding: 0.75rem 1rem;
      background-color: #f9fafb;
    }
    
    .dark .financial-table .subsection-header {
      background-color: #1f2937;
      color: #e5e7eb;
    }
    
    .financial-table .amount {
      text-align: right;
      position: relative;
    }
    
    .financial-table .indent-1 {
      padding-left: 2rem;
    }
    
    .financial-table .indent-2 {
      padding-left: 3.5rem;
    }
    
    .financial-table .total-row {
      background-color: #e0f2fe;
      font-weight: 600;
    }
    
    .dark .financial-table .total-row {
      background-color: #0c4a6e;
    }
    
    /* Add these new styles to support the new sections */
    .product-card {
      border-radius: 8px;
      overflow: hidden;
      transition: transform 0.2s ease;
    }
    
    .product-card:hover {
      transform: translateY(-5px);
    }
    
    .product-image {
      width: 100%;
      height: 140px;
      object-fit: cover;
    }
    
    .status-badge {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 500;
    }
    
    .status-good {
      background-color: rgba(16, 185, 129, 0.1);
      color: #10b981;
    }
    
    .dark .status-good {
      background-color: rgba(16, 185, 129, 0.2);
      color: #34d399;
    }
    
    .status-warning {
      background-color: rgba(245, 158, 11, 0.1);
      color: #f59e0b;
    }
    
    .dark .status-warning {
      background-color: rgba(245, 158, 11, 0.2);
      color: #fbbf24;
    }
    
    .status-alert {
      background-color: rgba(239, 68, 68, 0.1);
      color: #ef4444;
    }
    
    .dark .status-alert {
      background-color: rgba(239, 68, 68, 0.2);
      color: #f87171;
    }
    
    .campaign-card {
      border-left-width: 4px;
      transition: all 0.2s ease;
    }
    
    .campaign-card:hover {
      transform: translateX(4px);
    }

    @media (max-width: 768px) {
      .dashboard-cards {
        grid-template-columns: 1fr;
      }
      
      .financial-table {
        font-size: 0.875rem;
      }
      
      .menu-bar {
        flex-wrap: nowrap;
        overflow-x: auto;
      }
      
      .card-value {
        font-size: 1.25rem;
      }
      
      .view-container {
        padding: 1rem;
      }
    }
    
    @media print {
      .navbar, .menu-bar, .display-toggle, .dashboard-cards {
        display: none;
      }
      
      .view-container {
        box-shadow: none;
        padding: 0;
      }
      
      body {
        font-size: 12pt;
      }
    }
    
    /* Thai Calendar Styles */
    .date-picker-container {
      position: relative;
      display: inline-block;
    }
    
    .date-picker-input {
      padding: 8px 12px;
      border: 1px solid #e5e7eb;
      border-radius: 4px;
      background-color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      min-width: 220px;
    }
    
    .dark .date-picker-input {
      background-color: #1f2937;
      border-color: #4b5563;
      color: #e7e7e7;
    }
    
    .thai-calendar {
      position: absolute;
      top: 100%;
      left: 0;
      margin-top: 4px;
      padding: 12px;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      z-index: 50;
      width: 280px;
      display: none;
    }
    
    .dark .thai-calendar {
      background-color: #1e293b;
      border-color: #4b5563;
    }
    
    .calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .month-year {
      font-weight: 500;
      font-size: 1.05rem;
    }
    
    .nav-btn {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 16px;
      color: #6b7280;
      padding: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 28px;
      height: 28px;
    }
    
    .dark .nav-btn {
      color: #9ca3af;
    }
    
    .calendar-days {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      margin-bottom: 8px;
    }
    
    .day-name {
      text-align: center;
      font-weight: 500;
      color: #6b7280;
      font-size: 0.85rem;
      padding: 4px 0;
    }
    
    .dark .day-name {
      color: #9ca3af;
    }
    
    .calendar-dates {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
    }
    
    .date-cell {
      height: 36px;
      width: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 0.9rem;
      transition: all 0.2s;
      margin: 1px;
    }
    
    .date-cell:hover:not(.disabled) {
      background-color: #f3f4f6;
      border-radius: 50%;
    }
    
    .dark .date-cell:hover:not(.disabled) {
      background-color: #374151;
    }
    
    .date-cell.disabled {
      color: #d1d5db;
      cursor: default;
      opacity: 0.4;
    }
    
    .dark .date-cell.disabled {
      color: #6b7280;
    }
    
    .date-cell.selected {
      background-color: #0ea5e9;
      color: white;
      border-radius: 50%;
    }
    
    .date-cell.today {
      border: 2px solid #0ea5e9;
      border-radius: 50%;
      font-weight: 500;
    }
    
    .dark .date-cell.today {
      border-color: #38bdf8;
    }
  </style>
  
  <!-- Additional Styles for Sales Analytics Dashboard -->
  <style>
    /* Styles from the second HTML structure, prefixed to avoid conflicts if necessary or integrated if general */
    /* For example, if body styles conflict, decide which one takes precedence or make them more specific */
    /* Keeping them separate for now for clarity */
    .sales-analytics-body { /* Assuming you might want to scope these styles */
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;'
        /* background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); */ /* This might conflict with main body bg */
        color: #333;
    }

    .sales-analytics-container { /* Renamed to avoid conflict with existing .container */
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
    }

    .sales-analytics-header {
        text-align: center;
        color: white; /* This will need dark mode consideration if kept */
        margin-bottom: 30px;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 30px;
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .sales-analytics-header h1 {
        font-size: 2.5rem;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .sales-analytics-header p {
        font-size: 1.1rem;
        opacity: 0.9;
    }

    .sales-dashboard-grid { /* Renamed to avoid conflict */
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 25px;
        margin-bottom: 30px;
    }

    .sales-card { /* Renamed to avoid conflict with existing .card */
        background: rgba(255, 255, 255, 0.95); /* Needs dark mode consideration */
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 25px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .sales-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
    }

    .sales-card-title { /* Renamed */
        font-size: 1.3rem;
        font-weight: 600;
        margin-bottom: 20px;
        color: #2c3e50; /* Needs dark mode consideration */
        border-bottom: 3px solid #3498db;
        padding-bottom: 10px;
    }

    .sales-chart-container { /* Renamed */
        position: relative;
        height: 300px;
        margin-top: 15px;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 15px;
        margin-top: 15px;
    }

    .stat-item {
        text-align: center;
        padding: 15px;
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        border-radius: 15px;
        color: white;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .stat-value {
        font-size: 1.8rem;
        font-weight: bold;
        margin-bottom: 5px;
    }

    .stat-label {
        font-size: 0.9rem;
        opacity: 0.9;
    }

    .kpi-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .kpi-card {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        color: white;
        padding: 25px;
        border-radius: 20px;
        text-align: center;
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        transition: transform 0.3s ease;
    }

    .kpi-card:hover {
        transform: scale(1.05);
    }

    .kpi-value {
        font-size: 2.2rem;
        font-weight: bold;
        margin-bottom: 8px;
    }

    .kpi-label {
        font-size: 1rem;
        opacity: 0.9;
    }

    .trend-indicator {
        margin-top: 10px;
        font-size: 0.9rem;
    }

    .trend-indicator.trend-up { /* Made more specific */
        color: #00ff88;
    }

    .trend-indicator.trend-down { /* Made more specific */
        color: #ff4757;
    }

    .product-list {
        max-height: 250px;
        overflow-y: auto;
    }

    .product-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
        border-bottom: 1px solid #eee; /* Needs dark mode consideration */
    }
    .dark .product-item {
        border-bottom: 1px solid #4a5568;
    }


    .product-name {
        font-weight: 500;
    }

    .product-sales {
        font-weight: bold;
        color: #27ae60;
    }

    .low-sales {
        color: #e74c3c;
    }

    .progress-bar {
        width: 100%;
        height: 8px;
        background: #ecf0f1; /* Needs dark mode consideration */
        border-radius: 4px;
        margin: 10px 0;
        overflow: hidden;
    }
    .dark .progress-bar {
        background: #374151;
    }

    .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #00c9ff 0%, #92fe9d 100%);
        transition: width 0.3s ease;
    }

    .table-container {
        overflow-x: auto;
        margin-top: 15px;
    }

    .data-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 0.9rem;
    }

    .data-table th,
    .data-table td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid #ddd; /* Needs dark mode consideration */
    }
    .dark .data-table td {
         border-bottom: 1px solid #4a5568;
    }


    .data-table th {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        font-weight: 600;
    }
    /* Dark mode for .data-table th might need adjustment if the gradient is preferred over a solid dark color */

    .data-table tr:hover {
        background-color: #f8f9fa; /* Needs dark mode consideration */
    }
    .dark .data-table tr:hover {
        background-color: #374151;
    }

    .alert {
        padding: 15px;
        border-radius: 10px;
        margin: 15px 0;
        border-left: 4px solid;
    }

    .alert-success {
        background-color: #d4edda;
        border-color: #28a745;
        color: #155724;
    }
    .dark .alert-success {
        background-color: rgba(16, 185, 129, 0.2); /* Example dark mode adaptation */
        border-color: #34d399;
        color: #a7f3d0;
    }


    .alert-warning {
        background-color: #fff3cd;
        border-color: #ffc107;
        color: #856404;
    }
    .dark .alert-warning {
        background-color: rgba(245, 158, 11, 0.2); /* Example dark mode adaptation */
        border-color: #fbbf24;
        color: #fde68a;
    }

    .alert-danger {
        background-color: #f8d7da;
        border-color: #dc3545;
        color: #721c24;
    }
     .dark .alert-danger {
        background-color: rgba(239, 68, 68, 0.2); /* Example dark mode adaptation */
        border-color: #f87171;
        color: #fecaca;
    }


    @media (max-width: 768px) {
        .sales-dashboard-grid { /* Updated selector */
            grid-template-columns: 1fr;
        }
        
        .kpi-cards {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .sales-analytics-header h1 { /* Updated selector */
            font-size: 2rem;
        }
    }

    .loading { /* This class was defined but not used in the provided HTML snippet */
        text-align: center;
        padding: 20px;
        color: #666; /* Needs dark mode consideration */
    }
    .dark .loading {
        color: #9ca3af;
    }


    .section-divider {
        height: 2px;
        background: linear-gradient(90deg, transparent, #667eea, transparent);
        margin: 40px 0 30px 0;
        border-radius: 1px;
    }
    /* Ensure dark mode compatibility for .section-divider if needed, though gradient might be fine */

  </style>
  
   <!-- Template สำหรับเมนู -->
  <template id="mainMenuTemplate">
    <div class="flex justify-center">
      <ul class="menu menu-horizontal p-0 bg-white dark:bg-gray-800 rounded-lg shadow-md space-x-2">
<!-- ซื้อ -->
<li tabindex="0" class="dropdown">
  <a class="flex justify-between items-center px-4 py-2">
    <i class="bi bi-cart-fill text-green-600 mr-2"></i> ซื้อ
    <i class="bi bi-caret-down-fill text-green-600 ml-1"></i> <!-- Added ml-1 for spacing -->
  </a>
  <ul class="p-2 bg-base-100 dark:bg-gray-700 shadow-lg rounded-lg space-y-1">
    <li class="submenu-item">
      <a href="purchase_order">
        <i class="bi bi-file-earmark-text text-green-500 mr-2"></i> ใบสั่งซื้อ
      </a>
    </li>
    <li class="submenu-item">
      <a href="purchase_product">
        <i class="bi bi-bag-fill text-green-500 mr-2"></i> ซื้อสินค้า
      </a>
    </li>
    <li class="submenu-item">
      <a href="purchase_asset"> 
        <i class="bi bi-archive-fill text-green-500 mr-2"></i> ซื้อสินทรัพย์ 
      </a>
      <li class="submenu-item">
      <a href="goods_receipt">
        <i class="bi bi-box-arrow-in-down text-green-500 mr-2"></i> ใบรับสินค้า 
      </a>
    </li>
    </li>
    <li class="submenu-item">
      <a href="supplier_details"> 
        <i class="bi bi-person-lines-fill text-green-500 mr-2"></i> รายละเอียดผู้จำหน่าย
      </a>
    </li>
    
    <li class="submenu-item">
      <a href="deposit_payment">
        <i class="bi bi-cash-stack text-green-500 mr-2"></i> ใบจ่ายเงินมัดจำ
      </a>
    </li>
    <li class="submenu-item">
      <a href="purchase_tax_invoice">
        <i class="bi bi-file-earmark-spreadsheet text-green-500 mr-2"></i> ใบกำกับภาษีซื้อ
      </a>
    </li>
    <li class="submenu-item">
      <a href="credit_note">
        <i class="bi bi-file-earmark-minus text-green-500 mr-2"></i> ใบลดหนี้
      </a>
    </li>
    <li class="submenu-item">
      <a href="debit_note">
        <i class="bi bi-file-earmark-plus text-green-500 mr-2"></i> ใบเพิ่มหนี้
      </a>
    </li>
    <li class="submenu-item expense-group">
      <a href="expense_record">
        <i class="bi bi-journal-text text-green-500 mr-2"></i> บันทึกค่าใช้จ่าย
      </a>
    </li>
  </ul>
</li>
      
        <!-- ขาย -->
        <li tabindex="0" class="dropdown">
          <a class="flex justify-between items-center px-4 py-2">
            <i class="bi bi-shop text-red-600 mr-2"></i> ขาย
            <i class="bi bi-caret-down-fill text-red-600 ml-1"></i>
          </a>
          <ul class="p-2 bg-base-100 dark:bg-gray-700 shadow-lg rounded-lg">
            <li class="submenu-item">
              <a href="quotation">
                <i class="bi bi-file-earmark-text text-red-500 mr-2"></i> ใบเสนอราคา
              </a>
            </li>
            <li class="submenu-item">
              <a href="invoice">
                <i class="bi bi-receipt text-red-500 mr-2"></i> ใบแจ้งหนี้
              </a>
            </li>
            <li class="submenu-item">
              <a href="deposit_receipt">
                <i class="bi bi-file-earmark-check text-red-500 mr-2"></i> ใบรับเงินมัดจำ
              </a>
            </li>
            <li class="submenu-item">
              <a href="receipt">
                <i class="bi bi-receipt-cutoff text-red-500 mr-2"></i> ใบเสร็จรับเงิน
              </a>
            </li>
            <li class="submenu-item">
              <a href="sales_tax_invoice">
                <i class="bi bi-file-earmark-spreadsheet text-red-500 mr-2"></i> ใบกำกับภาษีขาย
              </a>
            </li>
            <li class="submenu-item">
              <a href="other_income">
                <i class="bi bi-cash-coin text-red-500 mr-2"></i> บันทึกรายได้อื่นๆ
              </a>
            </li>
            <li class="submenu-item">
              <a href="sales_debit_notee">
                <i class="bi bi-file-earmark-plus text-red-500 mr-2"></i> ใบเพิ่มหนี้
              </a>
            </li>
            <li class="submenu-item">
              <a href="sales_credit_notee">
                <i class="bi bi-file-earmark-minus text-red-500 mr-2"></i> ใบลดหนี้
              </a>
            </li>
            <!-- เพิ่มเมนู รายละเอียดลูกหนี้ -->
            <li class="submenu-item">
            <a href="customer_details">
            <i class="bi bi-people text-red-500 mr-2"></i> รายละเอียดลูกหนี้
            </a>
          </li>
          </ul>
        </li>
      
        <!-- บัญชี -->
         <li tabindex="0" class="dropdown">
          <a class="flex justify-between items-center px-4 py-2">
            <i class="bi bi-bank text-blue-600 mr-2"></i> บัญชี
            <i class="bi bi-caret-down-fill text-blue-600 ml-1"></i>
          </a>
          
          <ul class="p-2 bg-base-100 dark:bg-gray-700 shadow-lg rounded-lg">
            <li class="submenu-item">
              <a href="chart_of_accounts">
                <i class="bi bi-diagram-3-fill text-blue-500 mr-2"></i> ผังบัญชี
              </a>
            </li>

            <!-- หัวข้อย่อย ลงประจำวัน (Nested Dropdown) -->
            <li tabindex="0" class="submenu-item dropdown"> <!-- Added tabindex for focus -->
              <a href="javascript:void(0);" class="flex justify-between items-center w-full"> <!-- Use href for focusability -->
                <i class="bi bi-journal-text text-blue-500 mr-2"></i> ลงประจำวัน
                <i class="bi bi-caret-right-fill text-blue-500 ml-auto"></i>
              </a>
              <ul class="p-2 bg-base-100 dark:bg-gray-700 shadow-lg rounded-lg"> <!-- Nested UL for fly-out -->
                <li class="submenu-item">
                  <a href="journal_general">
                    <i class="bi bi-journal-text text-blue-500 mr-2"></i> สมุดรายวันทั่วไป
                  </a>
                </li>
                <li class="submenu-item">
                  <a href="journal_payment">
                    <i class="bi bi-journal-text text-blue-500 mr-2"></i> สมุดรายวันจ่าย
                  </a>
                </li>
                <li class="submenu-item">
                  <a href="journal_receipt">
                    <i class="bi bi-journal-text text-blue-500 mr-2"></i> สมุดรายวันรับ
                  </a>
                </li>
                <li class="submenu-item">
                  <a href="journal_sales">
                    <i class="bi bi-journal-text text-blue-500 mr-2"></i> สมุดรายวันขาย
                  </a>
                </li>
                <li class="submenu-item">
                  <a href="journal_purchase">
                    <i class="bi bi-journal-text text-blue-500 mr-2"></i> สมุดรายวันซื้อ
                  </a>
                </li>
              </ul>
            </li>

            <!-- เพิ่มเมนู งบกระแสเงินสด -->
            <li class="submenu-item">
              <a href="cash_flow">
                <i class="bi bi-cash text-blue-500 mr-2"></i> งบกระแสเงินสด
              </a>
            </li>
  
             <li class="submenu-item">
              <a href="social_security">
                <i class="bi bi-shield-check text-blue-500 mr-2"></i> ภาษีและประกันสังคม
              </a>
            </li>
            <li class="submenu-item">
              <a href="assets">
                <i class="bi bi-collection-fill text-blue-500 mr-2"></i> สินทรัพย์
              </a>
            </li>
            <!-- เพิ่มเมนู ทุน -->
            <li class="submenu-item">
              <a href="capital">
                <i class="bi bi-piggy-bank text-blue-500 mr-2"></i> ทุน
              </a>
            </li>
          </ul>
        </li>

 <!-- การเงิน -->
        <li tabindex="0" class="dropdown">
          <a class="flex justify-between items-center px-4 py-2">
            <i class="bi bi-currency-exchange text-teal-600 mr-2"></i> การเงิน
            <i class="bi bi-caret-down-fill text-teal-600 ml-1"></i>
          </a>
          <ul class="p-2 bg-base-100 dark:bg-gray-700 shadow-lg rounded-lg">
            <li class="submenu-item">
              <a href="cash_management">
                <i class="bi bi-wallet2 text-teal-500 mr-2"></i> การจัดการเงินสด
              </a>
            </li>
            <li class="submenu-item">
              <a href="bank_reconciliation">
                <i class="bi bi-bank text-teal-500 mr-2"></i> กระทบยอดธนาคาร
              </a>
            </li>
            <li class="submenu-item">
              <a href="loan_management">
                <i class="bi bi-cash-coin text-teal-500 mr-2"></i> การจัดการเงินกู้
              </a>
            </li>
            <li class="submenu-item">
              <a href="investment_management">
                <i class="bi bi-bar-chart text-teal-500 mr-2"></i> การจัดการการลงทุน
              </a>
            </li>
             <li class="submenu-item">
              <a href="cash_flow_planning">
                <i class="bi bi-calendar3-range text-teal-500 mr-2"></i> วางแผนกระแสเงินสด
              </a>
            </li>
            <li class="submenu-item">
              <a href="received_checks">
                <i class="bi bi-receipt text-teal-500 mr-2"></i> เช็ครับ
              </a>
            </li>
            <li class="submenu-item">
              <a href="issued_checks">
                <i class="bi bi-journal-check text-teal-500 mr-2"></i> เช็คจ่าย
              </a>
            </li>
            <!-- เพิ่มเมนู ตั๋วเงินรับ และ ตั๋วเงินจ่าย -->
    <li class="submenu-item">
      <a href="promissory_notes_received">
        <i class="bi bi-file-earmark-text text-teal-500 mr-2"></i> ตั๋วเงินรับ
      </a>
    </li>
    <li class="submenu-item">
      <a href="promissory_notes_payable">
        <i class="bi bi-file-earmark-text text-teal-500 mr-2"></i> ตั๋วเงินจ่าย
      </a>
    </li>
            <li class="submenu-item">
              <a href="withholding_tax_received">
                <i class="bi bi-file-earmark-minus text-teal-500 mr-2"></i> ภาษีถูกหัก ณ ที่จ่าย
              </a>
            </li>
            <li class="submenu-item">
              <a href="withholding_tax_paid">
                <i class="bi bi-file-earmark-plus text-teal-500 mr-2"></i> ภาษีหัก ณ ที่จ่าย
              </a>
            </li>
          </ul>
        </li>

      
        <!-- สินค้า -->
<li tabindex="0" class="dropdown">
  <a class="flex justify-between items-center px-4 py-2">
    <i class="bi bi-box-seam text-amber-600 mr-2"></i> สินค้า
    <i class="bi bi-caret-down-fill text-amber-600 ml-1"></i>
  </a>
  <ul class="p-2 bg-base-100 dark:bg-gray-700 shadow-lg rounded-lg">
    <li class="submenu-item">
      <a href="product_details">
        <i class="bi bi-info-circle text-amber-500 mr-2"></i> รายละเอียดสินค้า
      </a>
    </li>
    <li class="submenu-item">
      <a href="service_details">
        <i class="bi bi-briefcase text-amber-500 mr-2"></i> รายละเอียดบริการ
      </a>
    </li>
    <!-- เพิ่มเมนูรายการเคลื่อนไหวสินค้า -->
    <li class="submenu-item">
      <a href="product_movements">
        <i class="bi bi-arrow-left-right text-amber-500 mr-2"></i> รายการเคลื่อนไหวสินค้า
      </a>
    </li>
    <li class="submenu-item">
      <a href="opening_inventory">
        <i class="bi bi-box-arrow-in-left text-amber-500 mr-2"></i> สินค้าคงเหลือต้นงวด
      </a>
    </li>
    <li class="submenu-item">
      <a href="closing_inventory">
        <i class="bi bi-box-arrow-right text-amber-500 mr-2"></i> สินค้าคงเหลือปลายงวด
      </a>
    </li>
  </ul>
</li>
      
       
      
       <!-- รายงาน -->
        <li tabindex="0" class="dropdown">
          <a class="flex justify-between items-center px-4 py-2">
            <i class="bi bi-folder2 text-cyan-600 mr-2"></i> รายงาน
            <i class="bi bi-caret-down-fill text-cyan-600 ml-1"></i>
          </a>
          <ul class="p-2 bg-base-100 dark:bg-gray-700 shadow-lg rounded-lg">
            <li class="submenu-item">
              <a href="inventory_report">
                <i class="bi bi-box-seam text-cyan-500 mr-2"></i> รายงานสินค้าคงเหลือ
              </a>
            </li>
             <!-- ... other report items ... -->
            <li class="submenu-item">
              <a href="purchase_summary_report"><i class="bi bi-cart-check text-cyan-500 mr-2"></i> รายงานสรุปยอดซื้อ</a>
            </li>
            <li class="submenu-item">
              <a href="sales_summary_report"><i class="bi bi-bar-chart text-cyan-500 mr-2"></i> รายงานสรุปยอดขาย</a>
            </li>
            <li class="submenu-item">
              <a href="financial_statement_report"><i class="bi bi-graph-up text-cyan-500 mr-2"></i> รายงานงบการเงิน</a>
            </li>
            <li class="submenu-item">
              <a href="product_cost_report"><i class="bi bi-cash-coin text-cyan-500 mr-2"></i> รายงานต้นทุนสินค้า</a>
            </li>
            <li class="submenu-item">
              <a href="customer_report"><i class="bi bi-people text-cyan-500 mr-2"></i> รายงานลูกหนี้</a>
            </li>
            <li class="submenu-item">
              <a href="supplier_report"><i class="bi bi-truck text-cyan-500 mr-2"></i> รายงานเจ้าหนี้</a>
            </li>
            
    <li class="submenu-item">
      <a href="trial_balance">
        <i class="bi bi-list-ul text-cyan-500 mr-2"></i> รายงานงบทดลอง
      </a>
    </li>
    <li class="submenu-item">
      <a href="financial_position">
        <i class="bi bi-columns-gap text-cyan-500 mr-2"></i> รายงานงบฐานะการเงิน
      </a>
    </li>
    <li class="submenu-item">
      <a href="income_statement">
        <i class="bi bi-cash-stack text-cyan-500 mr-2"></i> รายงานงบกำไรขาดทุน
      </a>
    </li>
    <!-- รายงานงบกระแสเงินสด -->
    <li class="submenu-item">
      <a href="cash_flow">
        <i class="bi bi-cash text-cyan-500 mr-2"></i> รายงานงบกระแสเงินสด
      </a>
    </li>
        <!-- รายงานบัญชีแยกประเภท -->
    <li class="submenu-item">
      <a href="general_ledger">
        <i class="bi bi-journal-text text-cyan-500 mr-2"></i> รายงานบัญชีแยกประเภท
      </a>
    </li>
           

            <!-- รายงานภาษี (Nested Dropdown) -->
            <li tabindex="0" class="submenu-item dropdown">
              <a href="javascript:void(0);" class="flex justify-between items-center w-full">
                <i class="bi bi-receipt text-cyan-500 mr-2"></i> รายงานภาษี
                <i class="bi bi-caret-right-fill text-cyan-500 ml-auto"></i>
              </a>
              <ul class="p-2 bg-base-100 dark:bg-gray-700 shadow-lg rounded-lg">
                <!-- ภาษีมูลค่าเพิ่ม (Deeper Nested Dropdown) -->
                <li tabindex="0" class="submenu-item dropdown">
                  <a href="javascript:void(0);" class="flex justify-between items-center w-full">
                    ภาษีมูลค่าเพิ่ม
                    <i class="bi bi-caret-right-fill text-cyan-500 ml-auto"></i>
                  </a>
                  <ul class="p-2 bg-base-100 dark:bg-gray-700 shadow-lg rounded-lg">
                    <li class="submenu-item">
                      <a href="vat_purchase_report">
                        <i class="bi bi-arrow-down-circle text-cyan-500 mr-2"></i> ภาษีซื้อ
                      </a>
                    </li>
                    <li class="submenu-item">
                      <a href="vat_sales_report">
                        <i class="bi bi-arrow-up-circle text-cyan-500 mr-2"></i> ภาษีขาย
                      </a>
                    </li>
                  </ul>
                </li>
                <li class="submenu-item">
                  <a href="withholding_tax_report">
                    <i class="bi bi-currency-exchange text-cyan-500 mr-2"></i> ภาษีหัก ณ ที่จ่าย
                  </a>
                </li>
              </ul>
            </li>
                
            <li class="submenu-item">
              <a href="sales_analysis_report"><i class="bi bi-bar-chart-line text-cyan-500 mr-2"></i> รายงานวิเคราะห์การขาย</a>
            </li>
            <li class="submenu-item">
              <a href="purchase_analysis_report"><i class="bi bi-graph-up-arrow text-cyan-500 mr-2"></i> รายงานวิเคราะห์การซื้อ</a>
            </li>
          </ul>
        </li>
      
        <!-- ตั้งค่า -->
        <li tabindex="0" class="dropdown">
          <a class="flex justify-between items-center px-4 py-2">
            <i class="bi bi-gear-fill text-slate-600 mr-2"></i> ตั้งค่า
            <i class="bi bi-caret-down-fill text-slate-600 ml-1"></i>
          </a>
          <ul class="p-2 bg-base-100 dark:bg-gray-700 shadow-lg rounded-lg">
            
            <li class="submenu-item"><a href="organization_settings"><i class="bi bi-building text-slate-500 mr-2"></i> ตั้งค่าองค์กร</a></li>
            <li class="submenu-item"><a href="user_settings"><i class="bi bi-person-gear text-slate-500 mr-2"></i> ตั้งค่าผู้ใช้งาน</a></li>
            <li class="submenu-item"><a href="document_settings"><i class="bi bi-file-earmark-text text-slate-500 mr-2"></i> ตั้งค่าเอกสาร</a></li>
            <li class="submenu-item"><a href="accounting_policy"><i class="bi bi-shield-lock text-slate-500 mr-2"></i> นโยบายบัญชี</a></li>
            <li class="submenu-item"><a href="external_integration"><i class="bi bi-plug-fill text-slate-500 mr-2"></i> เชื่อมต่อภายนอก</a></li>
            <li class="submenu-item"><a href="register_accounting_firm"><i class="bi bi-journal-bookmark-fill text-slate-500 mr-2"></i> ลงทะเบียนสำนักงานบัญชี</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </template>

  <!-- Loading System -->
  <link rel="stylesheet" href="/css/loading-components.css">
  <script src="/js/loading-system.js"></script>

</head>

<body class="bg-white dark:bg-gray-900 dark:text-white w-full h-screen">
  <!-- Loading Spinner -->
<div id="loadingSpinner" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
  <div class="loader"></div>
</div>
  <div id="mainContent" class="container mx-auto px-4 py-6">
    <!-- Navbar -->
    <div class="navbar bg-white dark:bg-gray-800 shadow-md sticky top-0"> <!-- Removed z-30 from navbar, menu will handle z-index -->
      <div class="flex-1 flex items-center space-x-6">
        <img src="/uploads/Logo2.png"
             alt="Logo"
             class="rounded-full shadow-lg"
             style="width: 40px; height: 40px;" />
        <span class="text-lg font-semibold">บัญชี - วิเคราะห์ขาย</span>
        <!-- จุดปล่อยเมนู -->
        <div id="mainMenuContainer" class="ml-auto"></div> <!-- Added ml-auto to push menu towards center/right if space allows -->
      </div>
      <div class="flex-none flex items-center space-x-2">
  <!-- เพิ่มส่วนแสดงข้อมูลผู้ใช้ -->
  <div class="flex items-center space-x-3 mr-4">
    <img id="employeePhoto" 
     alt="Profile" 
     class="w-10 h-10 rounded-full border-2 border-gray-300 dark:border-gray-600">
    <span id="employeeName" class="text-sm font-medium text-gray-700 dark:text-gray-300">Loading...</span>
  </div>
  
  <button id="btnToggleDark" class="btn btn-rounded bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600">
    <i id="themeIcon" class="bi bi-moon-stars-fill mr-2 text-gray-700 dark:text-yellow-300"></i>
    <span id="darkModeLabel">Dark Mode</span>
  </button>
        <button id="btnLogout" class="btn btn-outline btn-primary btn-sm btn-rounded btn-fancy">
          <i class="bi bi-box-arrow-right mr-1"></i> ออกจากระบบ
        </button>
      </div>
    </div>

    <!-- Sales Analytics Dashboard Content Start -->
    <div class="sales-analytics-container sales-analytics-body"> <!-- Added sales-analytics-body for scoping if needed -->
        <div class="sales-analytics-header"> <!-- Updated class -->
            <h1>📊 Sales Analytics Dashboard</h1>
            <p>รายงานวิเคราะห์การขายประจำเดือน | Updated: <span id="currentDate"></span></p>
        </div>

        <!-- Enhanced KPI Cards -->
<div class="kpi-cards grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
  <!-- Total Sales Card -->
  <div class="kpi-card bg-gradient-to-br from-blue-500 to-blue-700 rounded-2xl shadow-xl transform transition-all hover:scale-105 overflow-hidden">
    <div class="absolute top-0 right-0 w-24 h-24 bg-white/10 rounded-full -mt-10 -mr-10"></div>
    <div class="p-6 relative z-10">
      <div class="flex items-center mb-2">
        <i class="bi bi-graph-up-arrow text-white/90 text-2xl mr-3"></i>
        <div class="kpi-label text-white/90 font-medium">ยอดขายรวม (เดือนนี้)</div>
      </div>
      <div class="kpi-value text-white text-3xl font-bold mb-3" id="totalSales">฿2,450,000</div>
      <div class="trend-indicator trend-up bg-white/20 text-white px-3 py-1 rounded-full text-sm inline-flex items-center">
        <i class="bi bi-arrow-up-right mr-1"></i> +15.2% จากเดือนที่แล้ว
      </div>
    </div>
  </div>

  <!-- Total Units Card -->
  <div class="kpi-card bg-gradient-to-br from-emerald-500 to-emerald-700 rounded-2xl shadow-xl transform transition-all hover:scale-105 overflow-hidden">
    <div class="absolute top-0 right-0 w-24 h-24 bg-white/10 rounded-full -mt-10 -mr-10"></div>
    <div class="p-6 relative z-10">
      <div class="flex items-center mb-2">
        <i class="bi bi-boxes text-white/90 text-2xl mr-3"></i>
        <div class="kpi-label text-white/90 font-medium">จำนวนเครื่องที่ขาย</div>
      </div>
      <div class="kpi-value text-white text-3xl font-bold mb-3" id="totalUnits">1,245</div>
      <div class="trend-indicator trend-up bg-white/20 text-white px-3 py-1 rounded-full text-sm inline-flex items-center">
        <i class="bi bi-arrow-up-right mr-1"></i> +8.5% 
      </div>
    </div>
  </div>

  <!-- Goal Achievement Card -->
  <div class="kpi-card bg-gradient-to-br from-amber-500 to-amber-700 rounded-2xl shadow-xl transform transition-all hover:scale-105 overflow-hidden">
    <div class="absolute top-0 right-0 w-24 h-24 bg-white/10 rounded-full -mt-10 -mr-10"></div>
    <div class="p-6 relative z-10">
      <div class="flex items-center mb-2">
        <i class="bi bi-trophy text-white/90 text-2xl mr-3"></i>
        <div class="kpi-label text-white/90 font-medium">บรรลุเป้าหมาย</div>
      </div>
      <div class="kpi-value text-white text-3xl font-bold mb-3" id="goalAchievement">92%</div>
      <div class="flex items-center">
        <div class="w-full bg-white/30 rounded-full h-2.5 mr-2">
          <div class="bg-white h-2.5 rounded-full" style="width: 92%"></div>
        </div>
        <span class="text-white/90 text-xs">8%</span>
      </div>
    </div>
  </div>

  <!-- Return Rate Card -->
  <div class="kpi-card bg-gradient-to-br from-purple-500 to-purple-700 rounded-2xl shadow-xl transform transition-all hover:scale-105 overflow-hidden">
    <div class="absolute top-0 right-0 w-24 h-24 bg-white/10 rounded-full -mt-10 -mr-10"></div>
    <div class="p-6 relative z-10">
      <div class="flex items-center mb-2">
        <i class="bi bi-arrow-return-left text-white/90 text-2xl mr-3"></i>
        <div class="kpi-label text-white/90 font-medium">อัตราการคืนสินค้า</div>
      </div>
      <div class="kpi-value text-white text-3xl font-bold mb-3" id="returnRate">2.1%</div>
      <div class="trend-indicator trend-up bg-white/20 text-white px-3 py-1 rounded-full text-sm inline-flex items-center">
        <i class="bi bi-arrow-up-right mr-1"></i> +0.3%
      </div>
    </div>
  </div>
</div>

        <div class="section-divider"></div>

        <!-- Dashboard Grid -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
    <!-- สินค้าขายดี/ขายไม่ดี -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden transition-all hover:shadow-xl border border-gray-100 dark:border-gray-700">
        <div class="flex items-center justify-between p-5 border-b border-gray-100 dark:border-gray-700">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 flex items-center">
                <span class="mr-2">🏆</span> สินค้าขายดี vs ขายไม่ดี
            </h3>
            <div class="flex space-x-2">
                <button class="p-2 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                    <i class="bi bi-info-circle"></i>
                </button>
                <button class="p-2 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                    <i class="bi bi-three-dots-vertical"></i>
                </button>
            </div>
        </div>
        <div class="p-5 h-64">
            <canvas id="productChart"></canvas>
        </div>
    </div>

    <!-- ลูกค้ากลุ่มต่างๆ -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden transition-all hover:shadow-xl border border-gray-100 dark:border-gray-700">
        <div class="flex items-center justify-between p-5 border-b border-gray-100 dark:border-gray-700">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 flex items-center">
                <span class="mr-2">👥</span> กลุ่มลูกค้า
            </h3>
            <div class="flex space-x-2">
                <button class="p-2 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                    <i class="bi bi-info-circle"></i>
                </button>
                <button class="p-2 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                    <i class="bi bi-three-dots-vertical"></i>
                </button>
            </div>
        </div>
        <div class="p-5 h-64">
            <canvas id="customerChart"></canvas>
        </div>
    </div>

    <!-- ยอดขายตามสาขา -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden transition-all hover:shadow-xl border border-gray-100 dark:border-gray-700">
        <div class="flex items-center justify-between p-5 border-b border-gray-100 dark:border-gray-700">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 flex items-center">
                <span class="mr-2">🏢</span> ยอดขายตามสาขา
            </h3>
            <div class="flex space-x-2">
                <button class="p-2 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                    <i class="bi bi-info-circle"></i>
                </button>
                <button class="p-2 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                    <i class="bi bi-three-dots-vertical"></i>
                </button>
            </div>
        </div>
        <div class="p-5 h-64">
            <canvas id="branchChart"></canvas>
        </div>
    </div>

    <!-- เปรียบเทียบยอดขายรายเดือน -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden transition-all hover:shadow-xl border border-gray-100 dark:border-gray-700">
        <div class="flex items-center justify-between p-5 border-b border-gray-100 dark:border-gray-700">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 flex items-center">
                <span class="mr-2">📈</span> เปรียบเทียบยอดขายรายเดือน
            </h3>
            <div class="flex items-center space-x-3">
                <select class="text-sm bg-gray-100 dark:bg-gray-700 border-0 rounded-lg px-3 py-1.5 text-gray-600 dark:text-gray-300">
                    <option>2024</option>
                    <option>2023</option>
                </select>
                <div class="flex space-x-2">
                    <button class="p-2 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                        <i class="bi bi-info-circle"></i>
                    </button>
                    <button class="p-2 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                        <i class="bi bi-three-dots-vertical"></i>
                    </button>
                </div>
            </div>
        </div>
        <div class="p-5 h-64">
            <canvas id="monthlyComparisonChart"></canvas>
        </div>
    </div>

    <!-- เปรียบเทียบยอดขายรายวัน -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden transition-all hover:shadow-xl border border-gray-100 dark:border-gray-700">
        <div class="flex items-center justify-between p-5 border-b border-gray-100 dark:border-gray-700">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 flex items-center">
                <span class="mr-2">📅</span> เปรียบเทียบยอดขายรายวัน <span class="text-xs text-gray-500 dark:text-gray-400 ml-2">(7 วันล่าสุด)</span>
            </h3>
            <div class="flex space-x-2">
                <button class="p-2 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                    <i class="bi bi-info-circle"></i>
                </button>
                <button class="p-2 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                    <i class="bi bi-three-dots-vertical"></i>
                </button>
            </div>
        </div>
        <div class="p-5 h-64">
            <canvas id="dailyComparisonChart"></canvas>
        </div>
    </div>

    <!-- เปรียบเทียบยอดขายรายไตรมาส -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden transition-all hover:shadow-xl border border-gray-100 dark:border-gray-700">
        <div class="flex items-center justify-between p-5 border-b border-gray-100 dark:border-gray-700">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 flex items-center">
                <span class="mr-2">📊</span> เปรียบเทียบยอดขายรายไตรมาส
            </h3>
            <div class="flex items-center space-x-3">
                <div class="flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1">
                    <button class="px-3 py-1 text-xs rounded-md bg-white dark:bg-gray-600 shadow text-blue-600 dark:text-blue-400">2024</button>
                    <button class="px-3 py-1 text-xs rounded-md text-gray-500 dark:text-gray-300">2023</button>
                </div>
                <div class="flex space-x-2">
                    <button class="p-2 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                        <i class="bi bi-info-circle"></i>
                    </button>
                </div>
            </div>
        </div>
        <div class="p-5 h-64">
            <canvas id="quarterlyComparisonChart"></canvas>
        </div>
    </div>

    <!-- เปรียบเทียบยอดขายรายปี -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden transition-all hover:shadow-xl border border-gray-100 dark:border-gray-700 col-span-1 md:col-span-2 lg:col-span-2">
        <div class="flex items-center justify-between p-5 border-b border-gray-100 dark:border-gray-700">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 flex items-center">
                <span class="mr-2">🗓️</span> เปรียบเทียบยอดขายรายปี
            </h3>
            <div class="flex items-center space-x-3">
                <button class="text-sm bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 px-3 py-1 rounded-lg border border-blue-200 dark:border-blue-800 flex items-center">
                    <i class="bi bi-download mr-1"></i> ส่งออก PDF
                </button>
                <div class="flex space-x-2">
                    <button class="p-2 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                        <i class="bi bi-info-circle"></i>
                    </button>
                    <button class="p-2 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                        <i class="bi bi-three-dots-vertical"></i>
                    </button>
                </div>
            </div>
        </div>
        <div class="p-5 h-64">
            <canvas id="yearlyComparisonChart"></canvas>
        </div>
    </div>

    <!-- แนวโน้มการขาย -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden transition-all hover:shadow-xl border border-gray-100 dark:border-gray-700 col-span-1 lg:col-span-3">
        <div class="flex items-center justify-between p-5 border-b border-gray-100 dark:border-gray-700">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 flex items-center">
                <span class="mr-2">🔮</span> แนวโน้มการขาย & เป้าหมาย
            </h3>
            <div class="flex items-center space-x-3">
                <div class="flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1">
                    <button class="px-3 py-1 text-xs rounded-md bg-white dark:bg-gray-600 shadow text-blue-600 dark:text-blue-400">รายเดือน</button>
                    <button class="px-3 py-1 text-xs rounded-md text-gray-500 dark:text-gray-300">รายไตรมาส</button>
                    <button class="px-3 py-1 text-xs rounded-md text-gray-500 dark:text-gray-300">รายปี</button>
                </div>
                <div class="flex space-x-2">
                    <button class="p-2 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                        <i class="bi bi-info-circle"></i>
                    </button>
                    <button class="p-2 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                        <i class="bi bi-three-dots-vertical"></i>
                    </button>
                </div>
            </div>
        </div>
        <div class="p-5 h-64">
            <canvas id="trendChart"></canvas>
        </div>
    </div>

    <!-- อัตราการคืนสินค้า -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden transition-all hover:shadow-xl border border-gray-100 dark:border-gray-700 col-span-1 lg:col-span-3">
        <div class="flex items-center justify-between p-5 border-b border-gray-100 dark:border-gray-700">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 flex items-center">
                <span class="mr-2">↩️</span> อัตราการคืนสินค้าแยกตามสินค้า
            </h3>
            <div class="flex items-center space-x-3">
                <div class="relative">
                    <input type="text" placeholder="ค้นหาสินค้า..." class="pl-9 pr-4 py-2 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm border-0 focus:ring-2 focus:ring-blue-500">
                    <i class="bi bi-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                </div>
                <button class="text-sm bg-gray-100 dark:bg-gray-700 px-3 py-2 rounded-lg text-gray-600 dark:text-gray-300 flex items-center">
                    <i class="bi bi-funnel mr-2"></i> กรอง
                </button>
            </div>
        </div>
        <div class="overflow-x-auto">
            <table class="w-full">
                <thead>
                    <tr class="bg-gray-50 dark:bg-gray-750">
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">สินค้า</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">จำนวนขาย</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">จำนวนคืน</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">อัตราการคืน</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">สาเหตุหลัก</th>
                    </tr>
                </thead>
                <tbody id="returnRateTable" class="divide-y divide-gray-200 dark:divide-gray-700">
                    <tr class="hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors">
                        <td class="px-6 py-4 whitespace-nowrap">iPhone 15</td>
                        <td class="px-6 py-4 whitespace-nowrap">320</td>
                        <td class="px-6 py-4 whitespace-nowrap">6</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 py-1 text-xs rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">1.9%</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">ปัญหาการใช้งานแบตเตอรี่</td>
                    </tr>
                    <tr class="hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors">
                        <td class="px-6 py-4 whitespace-nowrap">Samsung S24</td>
                        <td class="px-6 py-4 whitespace-nowrap">280</td>
                        <td class="px-6 py-4 whitespace-nowrap">8</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 py-1 text-xs rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200">2.9%</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">ปัญหาจอแสดงผล</td>
                    </tr>
                    <tr class="hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors">
                        <td class="px-6 py-4 whitespace-nowrap">iPad Air</td>
                        <td class="px-6 py-4 whitespace-nowrap">180</td>
                        <td class="px-6 py-4 whitespace-nowrap">2</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 py-1 text-xs rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">1.1%</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">สินค้าไม่ตรงความต้องการ</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="flex justify-between items-center p-5 border-t border-gray-100 dark:border-gray-700">
            <div class="text-sm text-gray-500 dark:text-gray-400">
                แสดง 1-3 จาก 10 รายการ
            </div>
            <div class="flex space-x-2">
                <button class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <i class="bi bi-chevron-left"></i>
                </button>
                <button class="px-3 py-1 border border-blue-500 bg-blue-500 rounded text-white">1</button>
                <button class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">2</button>
                <button class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <i class="bi bi-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- รายละเอียดสินค้าขายดี/ขายไม่ดี -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden transition-all hover:shadow-xl border border-gray-100 dark:border-gray-700 col-span-1 lg:col-span-3">
        <div class="flex items-center justify-between p-5 border-b border-gray-100 dark:border-gray-700">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 flex items-center">
                <span class="mr-2">🎯</span> รายละเอียดสินค้าขายดี vs ขายไม่ดี
            </h3>
            <div class="flex items-center space-x-3">
                <select class="text-sm bg-gray-100 dark:bg-gray-700 border-0 rounded-lg px-3 py-1.5 text-gray-600 dark:text-gray-300">
                    <option>เดือนนี้</option>
                    <option>เดือนที่แล้ว</option>
                    <option>ไตรมาสนี้</option>
                </select>
            </div>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 p-5">
            <div class="bg-green-50 dark:bg-green-900/20 p-5 rounded-xl border border-green-100 dark:border-green-800">
                <h4 class="text-green-700 dark:text-green-400 font-medium mb-4 flex items-center">
                    <span class="mr-2">✅</span> สินค้าขายดี (Top 5)
                </h4>
                <div id="topProducts" class="space-y-4">
                    <!-- Item 1 -->
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-white dark:bg-gray-700 rounded-lg flex items-center justify-center mr-3 shadow-sm">
                            <i class="bi bi-phone text-2xl text-blue-500"></i>
                        </div>
                        <div class="flex-grow">
                            <div class="flex justify-between mb-1">
                                <span class="font-medium text-gray-800 dark:text-gray-200">iPhone 15</span>
                                <span class="font-semibold text-green-600 dark:text-green-400">320 เครื่อง</span>
                            </div>
                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                <div class="bg-gradient-to-r from-green-400 to-green-600 h-2 rounded-full" style="width: 100%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Item 2 -->
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-white dark:bg-gray-700 rounded-lg flex items-center justify-center mr-3 shadow-sm">
                            <i class="bi bi-phone text-2xl text-indigo-500"></i>
                        </div>
                        <div class="flex-grow">
                            <div class="flex justify-between mb-1">
                                <span class="font-medium text-gray-800 dark:text-gray-200">Samsung S24</span>
                                <span class="font-semibold text-green-600 dark:text-green-400">280 เครื่อง</span>
                            </div>
                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                <div class="bg-gradient-to-r from-green-400 to-green-600 h-2 rounded-full" style="width: 87%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Additional items would be added here -->
                </div>
            </div>
            
            <div class="bg-red-50 dark:bg-red-900/20 p-5 rounded-xl border border-red-100 dark:border-red-800">
                <h4 class="text-red-700 dark:text-red-400 font-medium mb-4 flex items-center">
                    <span class="mr-2">❌</span> สินค้าขายไม่ดี (Bottom 5)
                </h4>
                <div id="bottomProducts" class="space-y-4">
                    <!-- Item 1 -->
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-white dark:bg-gray-700 rounded-lg flex items-center justify-center mr-3 shadow-sm">
                            <i class="bi bi-phone text-2xl text-gray-400"></i>
                        </div>
                        <div class="flex-grow">
                            <div class="flex justify-between mb-1">
                                <span class="font-medium text-gray-800 dark:text-gray-200">Huawei P60</span>
                                <span class="font-semibold text-red-600 dark:text-red-400">80 เครื่อง</span>
                            </div>
                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                <div class="bg-gradient-to-r from-red-400 to-red-600 h-2 rounded-full" style="width: 25%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Item 2 -->
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-white dark:bg-gray-700 rounded-lg flex items-center justify-center mr-3 shadow-sm">
                            <i class="bi bi-tablet text-2xl text-gray-400"></i>
                        </div>
                        <div class="flex-grow">
                            <div class="flex justify-between mb-1">
                                <span class="font-medium text-gray-800 dark:text-gray-200">Xiaomi Pad</span>
                                <span class="font-semibold text-red-600 dark:text-red-400">65 เครื่อง</span>
                            </div>
                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                <div class="bg-gradient-to-r from-red-400 to-red-600 h-2 rounded-full" style="width: 20%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Additional items would be added here -->
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ยอดขายต่อพนักงาน (ปรับปรุง) -->
<div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden transition-all hover:shadow-xl border border-gray-100 dark:border-gray-700 mb-8">
    <!-- Header Section -->
    <div class="flex flex-col md:flex-row md:items-center md:justify-between p-5 border-b border-gray-100 dark:border-gray-700 gap-4">
        <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 flex items-center">
            <span class="inline-flex items-center justify-center w-8 h-8 rounded-lg bg-blue-100 dark:bg-blue-900/40 text-blue-600 dark:text-blue-400 mr-3">
                <i class="bi bi-people-fill"></i>
            </span>
            ยอดขายต่อพนักงาน
        </h3>
        
        <div class="flex flex-col md:flex-row items-center space-y-3 md:space-y-0 md:space-x-3">
            <!-- Search bar -->
            <div class="relative w-full md:w-auto">
                <input type="text" placeholder="ค้นหาพนักงาน..." class="w-full md:w-auto pl-9 pr-4 py-2 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm border border-gray-200 dark:border-gray-600 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <i class="bi bi-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
            </div>
            
            <!-- Controls -->
            <div class="flex items-center space-x-2 w-full md:w-auto justify-end">
                <div class="dropdown">
                    <button class="text-sm bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 px-3 py-2 rounded-lg text-gray-600 dark:text-gray-300 flex items-center transition-colors">
                        <i class="bi bi-funnel mr-2"></i> กรอง
                        <i class="bi bi-chevron-down ml-2 text-xs"></i>
                    </button>
                </div>
                
                <button class="text-sm bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 px-3 py-2 rounded-lg text-gray-600 dark:text-gray-300 flex items-center transition-colors">
                    <i class="bi bi-sort-down mr-2"></i> เรียง
                </button>
                
                <button class="text-sm bg-blue-50 dark:bg-blue-900/30 hover:bg-blue-100 dark:hover:bg-blue-800/40 text-blue-600 dark:text-blue-400 px-3 py-2 rounded-lg border border-blue-200 dark:border-blue-800 flex items-center transition-colors">
                    <i class="bi bi-download mr-2"></i> ส่งออก
                </button>
            </div>
        </div>
    </div>
    
    <!-- Table Section with Stats Summary -->
    <div class="p-5 grid grid-cols-1 md:grid-cols-4 gap-4">
        <!-- Summary Stats -->
        <div class="bg-gray-50 dark:bg-gray-750 rounded-xl p-4 flex flex-col justify-between md:col-span-1">
            <div class="mb-4">
                <h4 class="text-sm uppercase text-gray-500 dark:text-gray-400 font-medium mb-4">ภาพรวม</h4>
                
                <div class="space-y-4">
                    <div>
                        <div class="text-xs text-gray-500 dark:text-gray-400">ยอดขายทั้งหมด</div>
                        <div class="text-2xl font-bold text-gray-800 dark:text-gray-100">฿710,000</div>
                    </div>
                    
                    <div>
                        <div class="text-xs text-gray-500 dark:text-gray-400">พนักงานที่มียอดขายสูงสุด</div>
                        <div class="text-lg font-semibold text-gray-800 dark:text-gray-100">นิมะ มะยี</div>
                        <div class="text-sm text-blue-600 dark:text-blue-400">฿180,000</div>
                    </div>
                    
                    <div>
                        <div class="text-xs text-gray-500 dark:text-gray-400">จำนวนเครื่องขายทั้งหมด</div>
                        <div class="flex items-end space-x-2">
                            <div class="text-xl font-bold text-gray-800 dark:text-gray-100">48</div>
                            <div class="text-sm text-gray-500 dark:text-gray-400">เครื่อง</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mt-4">
                <div class="text-xs text-gray-500 dark:text-gray-400 mb-2">ยอดขายเทียบกับเป้า</div>
                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5">
                    <div class="bg-gradient-to-r from-green-500 to-emerald-500 h-2.5 rounded-full" style="width: 85%"></div>
                </div>
                <div class="flex justify-between text-xs mt-1">
                    <div class="text-gray-500 dark:text-gray-400">85%</div>
                    <div class="text-gray-500 dark:text-gray-400">เป้า: ฿830,000</div>
                </div>
            </div>
        </div>
        
        <!-- Table -->
        <div class="overflow-x-auto md:col-span-3">
            <table class="w-full">
                <thead>
                    <tr>
                        <th class="px-5 py-3.5 bg-gray-50 dark:bg-gray-750 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider rounded-tl-lg">พนักงาน</th>
                        <th class="px-5 py-3.5 bg-gray-50 dark:bg-gray-750 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">ยอดขาย</th>
                        <th class="px-5 py-3.5 bg-gray-50 dark:bg-gray-750 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">เครื่อง</th>
                        <th class="px-5 py-3.5 bg-gray-50 dark:bg-gray-750 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">ค่าคอมมิชชั่น</th>
                        <th class="px-5 py-3.5 bg-gray-50 dark:bg-gray-750 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider rounded-tr-lg">การจัดการ</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                    <!-- Employee 1 -->
                    <tr class="hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors">
                        <td class="px-5 py-4">
                            <div class="flex items-center">
                                <div class="h-10 w-10 flex-shrink-0">
                                    <div class="h-10 w-10 rounded-full bg-blue-100 dark:bg-blue-900/40 text-blue-600 dark:text-blue-400 flex items-center justify-center font-medium">
                                        วข
                                    </div>
                                </div>
                                <div class="ml-4">
                                    <div class="font-medium text-gray-800 dark:text-gray-200">โซเฟีย กากะบุตร</div>
                                    <div class="text-xs text-gray-500 dark:text-gray-400">รหัส: EMP-003</div>
                                </div>
                            </div>
                        </td>
                        <td class="px-5 py-4">
                            <div class="font-semibold text-gray-800 dark:text-gray-200">฿180,000</div>
                            <div class="mt-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5">
                                <div class="bg-green-500 h-1.5 rounded-full" style="width: 100%"></div>
                            </div>
                        </td>
                        <td class="px-5 py-4">
                            <div class="flex items-center space-x-2">
                                <span class="px-2.5 py-0.5 rounded-full bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-300 text-xs font-medium">
                                    ผ่อน: 6
                                </span>
                                <span class="px-2.5 py-0.5 rounded-full bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-300 text-xs font-medium">
                                    สด: 12
                                </span>
                            </div>
                        </td>
                        <td class="px-5 py-4">
                            <span class="font-semibold text-emerald-600 dark:text-emerald-400">฿9,000</span>
                        </td>
                        <td class="px-5 py-4">
                            <div class="flex items-center space-x-2">
                                <button class="p-1.5 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                                    </svg>
                                </button>
                                <button class="p-1.5 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                                        <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
                                    </svg>
                                </button>
                            </div>
                        </td>
                    </tr>
                    
                    <!-- Employee 2 -->
                    <tr class="hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors">
                        <td class="px-5 py-4">
                            <div class="flex items-center">
                                <div class="h-10 w-10 flex-shrink-0">
                                    <div class="h-10 w-10 rounded-full bg-purple-100 dark:bg-purple-900/40 text-purple-600 dark:text-purple-400 flex items-center justify-center font-medium">
                                        สร
                                    </div>
                                </div>
                                <div class="ml-4">
                                    <div class="font-medium text-gray-800 dark:text-gray-200">มุคลิส โตะแวมะ</div>
                                    <div class="text-xs text-gray-500 dark:text-gray-400">รหัส: EMP-002</div>
                                </div>
                            </div>
                        </td>
                        <td class="px-5 py-4">
                            <div class="font-semibold text-gray-800 dark:text-gray-200">฿120,000</div>
                            <div class="mt-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5">
                                <div class="bg-yellow-500 h-1.5 rounded-full" style="width: 67%"></div>
                            </div>
                        </td>
                        <td class="px-5 py-4">
                            <div class="flex items-center space-x-2">
                                <span class="px-2.5 py-0.5 rounded-full bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-300 text-xs font-medium">
                                    ผ่อน: 4
                                </span>
                                <span class="px-2.5 py-0.5 rounded-full bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-300 text-xs font-medium">
                                    สด: 8
                                </span>
                            </div>
                        </td>
                        <td class="px-5 py-4">
                            <span class="font-semibold text-emerald-600 dark:text-emerald-400">฿6,000</span>
                        </td>
                        <td class="px-5 py-4">
                            <div class="flex items-center space-x-2">
                                <button class="p-1.5 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                                    </svg>
                                </button>
                                <button class="p-1.5 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                                        <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
                                    </svg>
                                </button>
                            </div>
                        </td>
                    </tr>
                    
                    <!-- Employee 3 -->
                    <tr class="hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors">
                        <td class="px-5 py-4">
                            <div class="flex items-center">
                                <div class="h-10 w-10 flex-shrink-0">
                                    <div class="h-10 w-10 rounded-full bg-red-100 dark:bg-red-900/40 text-red-600 dark:text-red-400 flex items-center justify-center font-medium">
                                        สใ
                                    </div>
                                </div>
                                <div class="ml-4">
                                    <div class="font-medium text-gray-800 dark:text-gray-200">อัสมา มะยี</div>
                                    <div class="text-xs text-gray-500 dark:text-gray-400">รหัส: EMP-001</div>
                                </div>
                            </div>
                        </td>
                        <td class="px-5 py-4">
                            <div class="font-semibold text-gray-800 dark:text-gray-200">฿150,000</div>
                            <div class="mt-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5">
                                <div class="bg-blue-500 h-1.5 rounded-full" style="width: 83%"></div>
                            </div>
                        </td>
                        <td class="px-5 py-4">
                            <div class="flex items-center space-x-2">
                                <span class="px-2.5 py-0.5 rounded-full bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-300 text-xs font-medium">
                                    ผ่อน: 5
                                </span>
                                <span class="px-2.5 py-0.5 rounded-full bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-300 text-xs font-medium">
                                    สด: 10
                                </span>
                            </div>
                        </td>
                        <td class="px-5 py-4">
                            <span class="font-semibold text-emerald-600 dark:text-emerald-400">฿7,500</span>
                        </td>
                        <td class="px-5 py-4">
                            <div class="flex items-center space-x-2">
                                <button class="p-1.5 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                                    </svg>
                                </button>
                                <button class="p-1.5 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                                        <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
                                    </svg>
                                </button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- Pagination -->
    <div class="flex flex-col md:flex-row justify-between items-center p-5 border-t border-gray-100 dark:border-gray-700 space-y-3 md:space-y-0">
        <div class="text-sm text-gray-500 dark:text-gray-400">
            แสดง 1-3 จาก 5 รายการ
        </div>
        
        <div class="flex items-center space-x-4">
            <select class="text-sm bg-gray-100 dark:bg-gray-700 border-0 rounded-lg py-1 pl-2 pr-8 text-gray-600 dark:text-gray-300 appearance-none cursor-pointer focus:ring-2 focus:ring-blue-500">
                <option>5 รายการต่อหน้า</option>
                <option>10 รายการต่อหน้า</option>
                <option>20 รายการต่อหน้า</option>
            </select>
            
            <div class="flex space-x-1">
                <button disabled class="px-3 py-1 border border-gray-200 dark:border-gray-600 rounded-l-lg text-gray-400 dark:text-gray-500 cursor-not-allowed">
                    <i class="bi bi-chevron-left"></i>
                </button>
                <button class="px-3 py-1 border border-blue-500 bg-blue-500 rounded-none text-white">1</button>
                <button class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-none text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">2</button>
                <button class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-r-lg text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                    <i class="bi bi-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- โปรโมชั่นรายละเอียด -->
<div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden transition-all hover:shadow-xl border border-gray-100 dark:border-gray-700 mb-8">
    <div class="flex items-center justify-between p-5 border-b border-gray-100 dark:border-gray-700">
        <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 flex items-center">
            <span class="mr-2">🎉</span> วิเคราะห์โปรโมชั่นแต่ละแคมเปญ
        </h3>
        <div class="flex items-center space-x-3">
            <select class="text-sm bg-gray-100 dark:bg-gray-700 border-0 rounded-lg px-3 py-1.5 text-gray-600 dark:text-gray-300">
                <option>เรียงตาม ROI (สูง-ต่ำ)</option>
                <option>เรียงตาม ROI (ต่ำ-สูง)</option>
                <option>เรียงตามยอดขาย (สูง-ต่ำ)</option>
            </select>
            <button class="text-sm bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 px-3 py-1.5 rounded-lg border border-blue-200 dark:border-blue-800 flex items-center">
                <i class="bi bi-plus-lg mr-1"></i> สร้างแคมเปญใหม่
            </button>
        </div>
    </div>
    <div class="overflow-x-auto">
        <table class="w-full">
            <thead>
                <tr class="bg-gray-50 dark:bg-gray-750">
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">ชื่อแคมเปญ</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">ระยะเวลา</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">จำนวนผู้ใช้</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">ยอดขาย</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">ROI</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">สถานะ</th>
                </tr>
            </thead>
            <tbody id="promotionTable" class="divide-y divide-gray-200 dark:divide-gray-700">
                <!-- Sample data -->
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors">
                    <td class="px-6 py-4">
                        <div class="flex items-center">
                            <div class="w-10 h-10 rounded-lg bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center text-indigo-600 dark:text-indigo-400 mr-3">
                                <i class="bi bi-gift"></i>
                            </div>
                            <div>
                                <div class="font-medium text-gray-900 dark:text-gray-100">ลดราคา 10% สำหรับ iPhone</div>
                                <div class="text-gray-500 dark:text-gray-400 text-xs">ID: PROMO-001</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">1-15 มิ.ย. 2567</td>
                    <td class="px-6 py-4 whitespace-nowrap">245</td>
                    <td class="px-6 py-4 whitespace-nowrap">฿980,000</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center text-green-600 dark:text-green-400">
                            <i class="bi bi-arrow-up mr-1"></i> 320%
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 py-1 text-xs rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">ใช้งานอยู่</span>
                    </td>
                </tr>
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors">
                    <td class="px-6 py-4">
                        <div class="flex items-center">
                            <div class="w-10 h-10 rounded-lg bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center text-amber-600 dark:text-amber-400 mr-3">
                                <i class="bi bi-ticket-perforated"></i>
                            </div>
                            <div>
                                <div class="font-medium text-gray-900 dark:text-gray-100">แลกซื้อ Samsung ลดพิเศษ</div>
                                <div class="text-gray-500 dark:text-gray-400 text-xs">ID: PROMO-002</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">10-20 มิ.ย. 2567</td>
                    <td class="px-6 py-4 whitespace-nowrap">184</td>
                    <td class="px-6 py-4 whitespace-nowrap">฿736,000</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center text-green-600 dark:text-green-400">
                            <i class="bi bi-arrow-up mr-1"></i> 280%
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 py-1 text-xs rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">ใช้งานอยู่</span>
                    </td>
                </tr>
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors">
                    <td class="px-6 py-4">
                        <div class="flex items-center">
                            <div class="w-10 h-10 rounded-lg bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-400 mr-3">
                                <i class="bi bi-cash-coin"></i>
                            </div>
                            <div>
                                <div class="font-medium text-gray-900 dark:text-gray-100">ดาวน์ 0% นาน 12 เดือน</div>
                                <div class="text-gray-500 dark:text-gray-400 text-xs">ID: PROMO-003</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">5-25 มิ.ย. 2567</td>
                    <td class="px-6 py-4 whitespace-nowrap">156</td>
                    <td class="px-6 py-4 whitespace-nowrap">฿624,000</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center text-green-600 dark:text-green-400">
                            <i class="bi bi-arrow-up mr-1"></i> 220%
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 py-1 text-xs rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">ใช้งานอยู่</span>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- สรุปเป้าหมาย -->
<div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden transition-all hover:shadow-xl border border-gray-100 dark:border-gray-700 mb-8">
    <div class="flex items-center justify-between p-5 border-b border-gray-100 dark:border-gray-700">
        <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 flex items-center">
            <span class="mr-2">🎯</span> สรุปเป้าหมายเดือนที่ผ่านมา
        </h3>
        <div class="flex space-x-2">
            <button class="p-2 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                <i class="bi bi-info-circle"></i>
            </button>
            <button class="p-2 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                <i class="bi bi-three-dots-vertical"></i>
            </button>
        </div>
    </div>
    <div class="p-5">
        <div class="p-4 border border-yellow-200 dark:border-yellow-800 bg-yellow-50 dark:bg-yellow-900/30 rounded-lg mb-4 flex items-start">
            <div class="text-yellow-500 dark:text-yellow-400 mr-3 text-xl">
                <i class="bi bi-exclamation-triangle-fill"></i>
            </div>
            <div>
                <div class="font-semibold text-yellow-800 dark:text-yellow-300 mb-1">สถานะ: เหลืออีก 8% เพื่อบรรลุเป้าหมาย (฿200,000)</div>
                <div class="text-yellow-700 dark:text-yellow-400 text-sm">หากต้องการบรรลุเป้าหมาย จะต้องเพิ่มยอดขายอีก 200,000 บาท ภายใน 10 วัน</div>
            </div>
        </div>
        
        <div class="mb-4">
            <div class="flex justify-between mb-2">
                <div class="text-sm font-medium text-gray-700 dark:text-gray-300">ความคืบหน้า: 92%</div>
                <div class="text-sm font-medium text-gray-700 dark:text-gray-300">฿2,300,000 / ฿2,500,000</div>
            </div>
            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3">
                <div class="h-3 rounded-full bg-gradient-to-r from-blue-500 to-blue-700 relative" style="width: 92%">
                    <div class="absolute right-0 -top-1 w-5 h-5 bg-white dark:bg-gray-900 rounded-full border-2 border-blue-600 dark:border-blue-500 shadow"></div>
                </div>
            </div>
        </div>
        
        <div class="rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden">
            <div class="p-4 bg-gray-50 dark:bg-gray-750 flex items-start">
                <div class="p-2 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400 mr-3">
                    <i class="bi bi-lightbulb-fill"></i>
                </div>
                <div>
                    <h4 class="font-medium text-gray-800 dark:text-gray-200 mb-1">วิเคราะห์และข้อเสนอแนะ</h4>
                    <p class="text-gray-600 dark:text-gray-400 text-sm leading-relaxed">
                        ยอดขายเดือนนี้เพิ่มขึ้น <span class="text-green-600 dark:text-green-400 font-medium">15.2%</span> จากเดือนที่แล้ว แต่ยังไม่ถึงเป้าหมายที่ตั้งไว้ 
                        แนะนำให้เพิ่มกิจกรรมส่งเสริมการขายในสัปดาห์สุดท้ายของเดือน โดยเน้นที่:
                    </p>
                    <ul class="mt-2 space-y-1 text-sm text-gray-600 dark:text-gray-400 list-disc list-inside">
                        <li>เพิ่มโปรโมชั่นสำหรับ iPhone 15 และ Samsung S24 ซึ่งเป็นสินค้าขายดี</li>
                        <li>จัดกิจกรรมพิเศษสำหรับลูกค้าที่เคยซื้อสินค้าในเดือนที่แล้ว</li>
                        <li>เพิ่มแรงจูงใจให้พนักงานขายด้วยโบนัสพิเศษ</li>
                    </ul>
                </div>
            </div>
            <div class="p-4 border-t border-gray-200 dark:border-gray-700">
                <button class="w-full py-2 bg-blue-500 hover:bg-blue-600 text-white font-medium rounded-lg transition-colors flex items-center justify-center">
                    <i class="bi bi-file-earmark-text mr-2"></i> ดูรายงานฉบับเต็ม
                </button>
            </div>
        </div>
    </div>
</div>
    </div>
    <!-- Sales Analytics Dashboard Content End -->

  </div> <!-- End of mainContent -->

    <!-- Scripts for Sales Analytics Dashboard -->
    <!-- Chart.js is already included in the head, so no need to re-add if it's the same version -->'
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script> --> <!-- Already in head -->
    <script>
        // Main menu instantiation (assuming this script was part of the original page logic)
        const mainMenuTemplate = document.getElementById('mainMenuTemplate');'
        const mainMenuContainer = document.getElementById('mainMenuContainer');'
        if (mainMenuTemplate && mainMenuContainer) {
            mainMenuContainer.appendChild(mainMenuTemplate.content.cloneNode(true));
        }

        // Dark mode toggle (assuming this script was part of the original page logic)
        const btnToggleDark = document.getElementById('btnToggleDark');'
        const themeIcon = document.getElementById('themeIcon');'
        const darkModeLabel = document.getElementById('darkModeLabel');'
        if (btnToggleDark && themeIcon && darkModeLabel) {
            // Function to apply theme
            const applyTheme = (isDark) => {
                if (isDark) {
                    document.documentElement.classList.add('dark');'
                    themeIcon.classList.remove('bi-moon-stars-fill');'
                    themeIcon.classList.add('bi-sun-fill');'
                    darkModeLabel.textContent = 'Light Mode';'
                } else {
                    document.documentElement.classList.remove('dark');'
                    themeIcon.classList.remove('bi-sun-fill');'
                    themeIcon.classList.add('bi-moon-stars-fill');'
                    darkModeLabel.textContent = 'Dark Mode';'
                }
            };

            // Check local storage for theme
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;'
            let isDarkMode = localStorage.getItem('darkMode') === 'true' || (localStorage.getItem('darkMode') === null && prefersDark);'
            applyTheme(isDarkMode);

            btnToggleDark.addEventListener('click', () => {'
                isDarkMode = !isDarkMode;
                localStorage.setItem('darkMode', isDarkMode);'
                applyTheme(isDarkMode);
            });
        }
        
        // Logout functionality (assuming this script was part of the original page logic)
        const btnLogout = document.getElementById('btnLogout');'
        if (btnLogout) {
            btnLogout.addEventListener('click', () => {'
                // Implement logout logic here, e.g., redirect to logout URL or clear session
                alert('ออกจากระบบแล้ว'); // Placeholder'
                // window.location.href = '/logout'; // Example redirect'
            });
        }

        // Sales Analytics Dashboard Specific JavaScript
        document.addEventListener('DOMContentLoaded', function() {'
      const pageLoaderId = LoadingSystem.show({
        message: 'กำลังโหลดหน้าเว็บ...','
        showProgress: true,
        autoProgress: true,
        spinnerType: 'default''
      
      } catch (error) {
        console.error('Page loading error:', error);
      } finally {
        LoadingSystem.completeProgress();
      }});
      
      try {
            // Set current date
            const currentDateEl = document.getElementById('currentDate');'
            if (currentDateEl) {
                currentDateEl.textContent = new Date().toLocaleDateString('th-TH', {'
                    year: 'numeric','
                    month: 'long','
                    day: 'numeric''
                });
            }

            // Sample data for charts
            const sampleData = {
                products: {
                    labels: ['iPhone 15', 'Samsung S24', 'iPad Air', 'MacBook', 'AirPods', 'Huawei P60'],'
                    sales: [320, 280, 180, 150, 420, 80],
                    colors: ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57', '#ff9ff3']'
                },
                customers: {
                    labels: ['นักเรียน/นักศึกษา', 'ข้าราชการ', 'คนทั่วไป'],'
                    data: [35, 25, 40],
                    colors: ['#ff6b6b', '#4ecdc4', '#feca57']'
                },
                branches: {
                    labels: ['สาขาเซ็นทรัล', 'สาขาบิ๊กซี', 'สาขาโลตัส', 'สาขาออนไลน์', 'สาขาเทสโก้'],'
                    data: [450, 380, 320, 280, 220],
                    colors: ['#667eea', '#764ba2', '#f093fb', '#f5576c', '#4facfe']'
                }
            };

            // Product Performance Chart
            const productCtx = document.getElementById('productChart')?.getContext('2d');'
            if (productCtx) {
                new Chart(productCtx, {
                    type: 'bar', // Example: bar chart'
                    data: {
                        labels: sampleData.products.labels,
                        datasets: [{
                            label: 'จำนวนที่ขายได้','
                            data: sampleData.products.sales,
                            backgroundColor: sampleData.products.colors,
                            borderRadius: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: { color: 'rgba(0,0,0,0.1)' }'
                            },
                            x: {
                                grid: { display: false }
                            }
                        }
                    }
                }); // Added semicolon
            }

            // Customer Segments Chart
            const customerCtx = document.getElementById('customerChart')?.getContext('2d');'
            if (customerCtx) {
                new Chart(customerCtx, {
                    type: 'doughnut', // Example: doughnut chart'
                    data: {
                        labels: sampleData.customers.labels,
                        datasets: [{
                            label: 'กลุ่มลูกค้า','
                            data: sampleData.customers.data,
                            backgroundColor: sampleData.customers.colors,
                            hoverOffset: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top','
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        let label = context.label || '';'
                                        if (label) {
                                            label += ': ';'
                                        }
                                        if (context.parsed !== null) {
                                            label += context.parsed + '%';'
                                        }
                                        return label;
                                    }
                                }
                            }
                        }
                    }
                }); // Added semicolon
            }

            // Sales by Branch Chart
            const branchCtx = document.getElementById('branchChart')?.getContext('2d');'
            if (branchCtx) {
                new Chart(branchCtx, {
                    type: 'bar', // Example: bar chart'
                    data: {
                        labels: sampleData.branches.labels,
                        datasets: [{
                            label: 'ยอดขาย (พันบาท)','
                            data: sampleData.branches.data,
                            backgroundColor: sampleData.branches.colors,
                            borderRadius: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        indexAxis: 'y', // For horizontal bar chart'
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            x: {
                                beginAtZero: true,
                                grid: { color: 'rgba(0,0,0,0.1)' }'
                            },
                            y: {
                                grid: { display: false }
                            }
                        }
                    }
                }); // Added semicolon
            }
        });

        // Sales Comparison Chart - Monthly
        const monthlyComparisonCtx = document.getElementById('monthlyComparisonChart').getContext('2d');'
        new Chart(monthlyComparisonCtx, {
            type: 'line','
            data: {
                labels: ['ม.ค.', 'ก.พ.', 'มี.ค.', 'เม.ย.', 'พ.ค.', 'มิ.ย.'],'
                datasets: [{
                    label: 'ยอดขายรายเดือน','
                    data: [1800, 2100, 1950, 2300, 2150, 2450],
                    borderColor: '#667eea','
                    backgroundColor: 'rgba(102, 126, 234, 0.1)','
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: '#667eea','
                    pointBorderColor: '#fff','
                    pointBorderWidth: 3,
                    pointRadius: 6
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(0,0,0,0.1)''
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                }
            }
        }); // Added semicolon

        // Daily Sales Comparison Chart
        const dailyComparisonCtx = document.getElementById('dailyComparisonChart').getContext('2d');'
        new Chart(dailyComparisonCtx, {
            type: 'bar','
            data: {
                labels: ['จันทร์', 'อังคาร', 'พุธ', 'พฤหัส', 'ศุกร์', 'เสาร์', 'อาทิตย์'],'
                datasets: [{
                    label: 'ยอดขายรายวัน (พันบาท)','
                    data: [85, 92, 78, 105, 98, 125, 89],
                    backgroundColor: ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57', '#ff9ff3', '#a8e6cf'],'
                    borderRadius: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(0,0,0,0.1)''
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                }
            }
        }); // Added semicolon

        // Quarterly Sales Comparison Chart
        const quarterlyComparisonCtx = document.getElementById('quarterlyComparisonChart').getContext('2d');'
        new Chart(quarterlyComparisonCtx, {
            type: 'bar','
            data: {
                labels: ['Q1 2024', 'Q2 2024', 'Q3 2024', 'Q4 2024', 'Q1 2025', 'Q2 2025'],'
                datasets: [{
                    label: 'ยอดขายรายไตรมาส (ล้านบาท)','
                    data: [5.85, 6.90, 7.25, 8.15, 6.20, 7.35],
                    backgroundColor: '#667eea','
                    borderRadius: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(0,0,0,0.1)''
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                }
            }
        }); // Added semicolon

        // Yearly Sales Comparison Chart
        const yearlyComparisonCtx = document.getElementById('yearlyComparisonChart').getContext('2d');'
        new Chart(yearlyComparisonCtx, {
            type: 'line','
            data: {
                labels: ['2020', '2021', '2022', '2023', '2024', '2025 (คาดการณ์)'],'
                datasets: [{
                    label: 'ยอดขายรายปี (ล้านบาท)','
                    data: [18.5, 22.3, 26.8, 24.9, 28.2, 32.5],
                    borderColor: '#4ecdc4','
                    backgroundColor: 'rgba(78, 205, 196, 0.1)','
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: '#4ecdc4','
                    pointBorderColor: '#fff','
                    pointBorderWidth: 3,
                    pointRadius: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top','
                        labels: {
                            padding: 20,
                            usePointStyle: true
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(0,0,0,0.1)''
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                }
            }
        }); // Added semicolon

        // Trend & Forecast Chart
        const trendCtx = document.getElementById('trendChart').getContext('2d');'
        new Chart(trendCtx, {
            type: 'line','
            data: {
                labels: ['ม.ค.', 'ก.พ.', 'มี.ค.', 'เม.ย.', 'พ.ค.', 'มิ.ย.', 'ก.ค.', 'ส.ค.'],'
                datasets: [{
                    label: 'ยอดขายจริง','
                    data: [1800, 2100, 1950, 2300, 2150, 2450, null, null],
                    borderColor: '#4ecdc4','
                    backgroundColor: 'rgba(78, 205, 196, 0.1)','
                    fill: true,
                    tension: 0.4
                }, {
                    label: 'คาดการณ์','
                    data: [null, null, null, null, null, 2450, 2600, 2750],
                    borderColor: '#ff6b6b','
                    backgroundColor: 'rgba(255, 107, 107, 0.1)','
                    fill: false,
                    borderDash: [10, 5],
                    tension: 0.4
                }, {
                    label: 'เป้าหมาย','
                    data: [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000],
                    borderColor: '#feca57','
                    backgroundColor: 'transparent','
                    fill: false,
                    borderDash: [5, 5],
                    pointRadius: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top','
                        labels: {
                            padding: 20,
                            usePointStyle: true
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(0,0,0,0.1)''
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                }
            }
        }); // Added semicolon

        // Employee Performance Table
        const employeeData = [
            { name: 'สมชาย ใจดี', totalSales: 150000, downPaymentUnits: 5, cashUnits: 10, commission: 7500 },'
            { name: 'สมหญิง รักงาน', totalSales: 120000, downPaymentUnits: 4, cashUnits: 8, commission: 6000 },'
            { name: 'วิชัย ขยัน', totalSales: 180000, downPaymentUnits: 6, cashUnits: 12, commission: 9000 },'
            { name: 'นงลักษณ์ เก่ง', totalSales: 100000, downPaymentUnits: 3, cashUnits: 7, commission: 5000 },'
            { name: 'ธนาคาร ซื่อสัตย์', totalSales: 160000, downPaymentUnits: 5, cashUnits: 11, commission: 8000 }'
        ];

        const employeeTableBody = document.getElementById('employeeTable');'
        if (employeeTableBody) { // Add a check for employeeTableBody
            employeeData.forEach(emp => {
                const row = employeeTableBody.insertRow();
                row.innerHTML = `
                    <td>${emp.name}</td>
                    <td>฿${emp.totalSales.toLocaleString()}</td>
                    <td>${emp.downPaymentUnits}</td>
                    <td>${emp.cashUnits}</td>
                    <td>฿${emp.commission.toLocaleString()}</td>
                `;
            });
        }

        // Animate numbers on load
        function animateValue(id, start, end, duration) {
            const element = document.getElementById(id);
            const range = end - start;
            const increment = end > start ? 1 : -1;
            const stepTime = Math.abs(Math.floor(duration / range));
            let current = start;
            
            const timer = setInterval(() => {
                current += increment;
                if (id === 'totalSales') {'
                    element.textContent = '฿' + current.toLocaleString();'
                } else if (id === 'goalAchievement' || id === 'returnRate') {'
                    element.textContent = current + '%';'
                } else {
                    element.textContent = current.toLocaleString();
                }
                
                if (current === end) {
                    clearInterval(timer);
                }
            }, stepTime);
        }

        // Animate KPI values
        setTimeout(() => {
            animateValue('totalSales', 0, 2450000, 2000);'
            animateValue('totalUnits', 0, 1245, 1500);'
            animateValue('goalAchievement', 0, 92, 1000);'
            animateValue('returnRate', 0, 2.1, 800);'
        }, 500);
    
}</script>
</body>
</html>