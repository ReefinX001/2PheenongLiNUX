<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TikTok Login Demo | 2 ‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á ‡πÇ‡∏°‡∏ö‡∏≤‡∏¢</title>
    <link rel="stylesheet" href="/views/FrontStore/styles.css?v=19">
    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .demo-container {
            max-width: 800px;
            margin: 40px auto;
            padding: 40px;
            background: white;
            border-radius: 24px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        .demo-header {
            text-align: center;
            margin-bottom: 40px;
        }
        .demo-header h1 {
            font-size: 32px;
            margin: 0 0 16px;
            color: #1a1a1a;
        }
        .demo-header p {
            font-size: 18px;
            color: #6b7280;
        }
        .tiktok-btn {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            background: #000;
            color: white;
            padding: 16px 32px;
            border-radius: 12px;
            text-decoration: none;
            font-size: 18px;
            font-weight: 600;
            transition: all 0.2s;
            margin: 20px 0;
        }
        .tiktok-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.2);
        }
        .tiktok-btn svg {
            width: 24px;
            height: 24px;
        }
        .user-info {
            background: #f3f4f6;
            padding: 24px;
            border-radius: 12px;
            margin: 20px 0;
        }
        .user-info h3 {
            font-size: 20px;
            margin: 0 0 16px;
            color: #1a1a1a;
        }
        .user-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin-bottom: 16px;
        }
        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #e5e7eb;
        }
        .info-item:last-child {
            border-bottom: none;
        }
        .info-label {
            font-weight: 600;
            color: #374151;
        }
        .info-value {
            color: #6b7280;
        }
        .logout-btn {
            background: #dc2626;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s;
        }
        .logout-btn:hover {
            background: #b91c1c;
        }
        .config-section {
            background: #fef3c7;
            border: 1px solid #fbbf24;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
        }
        .config-section h3 {
            font-size: 18px;
            margin: 0 0 12px;
            color: #92400e;
        }
        .config-item {
            font-family: monospace;
            font-size: 14px;
            background: #fffbeb;
            padding: 8px 12px;
            border-radius: 6px;
            margin: 8px 0;
            word-break: break-all;
        }
        .loading {
            text-align: center;
            padding: 40px;
            color: #6b7280;
        }
        .error-msg {
            background: #fee;
            color: #dc2626;
            padding: 16px;
            border-radius: 8px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-container">
            <div class="nav-links">
                <a href="Promotions" class="nav-link">‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô</a>
                <a href="Product" class="nav-link">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a>
                <div class="nav-brand">
                    <a href="/" class="brand-link" title="‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å">
                        <img src="/views/FrontStore/Logo2png.png" alt="2‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á ‡πÇ‡∏°‡∏ö‡∏≤‡∏¢" class="brand-logo">
                    </a>
                </div>
                <a href="JoinUs" class="nav-link">‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</a>
                <a href="Contact" class="nav-link">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</a>
            </div>
        </div>
    </nav>

    <div class="demo-container">
        <div class="demo-header">
            <h1>üéµ TikTok Login Demo</h1>
            <p>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢ TikTok OAuth 2.0</p>
        </div>

        <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ -->
        <div class="config-section">
            <h3>‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</h3>
            <div class="config-item">
                <strong>Redirect URI:</strong> https://www.2pheenong.com/callback
            </div>
            <div class="config-item">
                <strong>Scopes:</strong> user.info.basic, video.list
            </div>
            <div class="config-item">
                <strong>Client Key:</strong> <span id="client-key">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span>
            </div>
        </div>

        <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ login -->
        <div id="not-logged-in" style="text-align: center;">
            <p style="color: #6b7280; margin-bottom: 24px;">
                ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏ö‡∏±‡∏ç‡∏ä‡∏µ TikTok ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
            </p>
            
            <a href="/api/tiktok/login" class="tiktok-btn">
                <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M34.145 0H25.084V32.57C25.084 36.84 21.638 40.286 17.367 40.286C13.097 40.286 9.65 36.84 9.65 32.57C9.65 28.299 13.097 24.853 17.367 24.853V15.792C8.095 15.792 0.59 23.297 0.59 32.57C0.59 41.842 8.095 49.347 17.367 49.347C26.64 49.347 34.145 41.842 34.145 32.57V15.903C37.358 18.193 41.288 19.5 45.511 19.5V10.44C40.298 10.44 35.844 7.273 34.145 2.846V0Z" fill="white"/>
                </svg>
                Continue with TikTok
            </a>
        </div>

        <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà login ‡πÅ‡∏•‡πâ‡∏ß -->
        <div id="logged-in" style="display: none;">
            <div class="user-info">
                <h3>‚úÖ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h3>
                <div class="loading" id="user-loading">
                    <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ...</p>
                </div>
                <div id="user-data" style="display: none;">
                    <img id="user-avatar" class="user-avatar" src="" alt="Avatar" style="display: none;">
                    <div class="info-item">
                        <span class="info-label">Display Name:</span>
                        <span class="info-value" id="user-name">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Open ID:</span>
                        <span class="info-value" id="user-openid">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Union ID:</span>
                        <span class="info-value" id="user-unionid">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Session ID:</span>
                        <span class="info-value" id="session-id">-</span>
                    </div>
                </div>
                <div id="user-error" class="error-msg" style="display: none;"></div>
            </div>
            
            <div style="text-align: center; margin-top: 24px;">
                <button class="logout-btn" onclick="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
            </div>
        </div>

        <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° -->
        <div style="margin-top: 40px; padding-top: 40px; border-top: 1px solid #e5e7eb;">
            <h3 style="font-size: 20px; margin-bottom: 16px;">üìö ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</h3>
            <ol style="line-height: 1.8; color: #4b5563;">
                <li>‡∏Ñ‡∏•‡∏¥‡∏Å "Continue with TikTok" ‡∏à‡∏∞ redirect ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ authorize ‡∏Ç‡∏≠‡∏á TikTok</li>
                <li>‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</li>
                <li>TikTok redirect ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏ó‡∏µ‡πà <code>/callback</code> ‡∏û‡∏£‡πâ‡∏≠‡∏° authorization code</li>
                <li>‡πÅ‡∏•‡∏Å code ‡πÄ‡∏õ‡πá‡∏ô access token ‡∏ú‡πà‡∏≤‡∏ô API</li>
                <li>‡πÉ‡∏ä‡πâ access token ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</li>
            </ol>
            
            <h3 style="font-size: 20px; margin: 24px 0 16px;">üîß ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô .env</h3>
            <pre style="background: #1e293b; color: #e2e8f0; padding: 16px; border-radius: 8px; overflow-x: auto;">
TIKTOK_CLIENT_KEY=your_client_key_here
TIKTOK_CLIENT_SECRET=your_client_secret_here
TIKTOK_REDIRECT_URI=https://www.2pheenong.com/callback</pre>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-main">
                <div class="footer-section">
                    <div class="footer-brand">
                        <img src="/views/FrontStore/Logo2png.png" alt="2‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á ‡πÇ‡∏°‡∏ö‡∏≤‡∏¢" class="footer-logo">
                        <h2 class="footer-title">2 ‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á ‡πÇ‡∏°‡∏ö‡∏≤‡∏¢</h2>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3 class="footer-contact-title">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</h3>
                    <div class="footer-contact">
                        <p class="company-name">‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó 2 ‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á ‡πÇ‡∏°‡∏ö‡∏≤‡∏¢ ‡∏à‡∏≥‡∏Å‡∏±‡∏î</p>
                        <p class="company-address">148/91 ‡∏ï‡∏≥‡∏ö‡∏• ‡∏£‡∏π‡∏™‡∏∞‡∏°‡∏¥‡πÅ‡∏• ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏õ‡∏±‡∏ï‡∏ï‡∏≤‡∏ô‡∏µ 94000</p>
                        <p class="company-phone">üìû 092 427 0769</p>
                        <p class="company-email">‚úâÔ∏è support@2pheenong.com</p>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3 class="footer-menu-title">2 ‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á ‡πÇ‡∏°‡∏ö‡∏≤‡∏¢</h3>
                    <div class="footer-menu">
                        <a href="/Promotions" class="footer-link">‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô</a>
                        <a href="/Contact" class="footer-link">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</a>
                        <a href="/terms" class="footer-link">‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</a>
                        <a href="/privacy" class="footer-link">‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</a>
                        <a href="#" onclick="if(cookieConsent) cookieConsent.showSettings(); return false;" class="footer-link">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∏‡∏Å‡∏Å‡∏µ‡πâ</a>
                    </div>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 2 ‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á ‡πÇ‡∏°‡∏ö‡∏≤‡∏¢. ‡∏™‡∏á‡∏ß‡∏ô‡∏•‡∏¥‡∏Ç‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏£</p>
            </div>
        </div>
    </footer>

    <script>
        // ‡πÅ‡∏™‡∏î‡∏á client key (‡∏ã‡πà‡∏≠‡∏ô‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô)
        const clientKey = 'your_client_key'; // ‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å server ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á
        document.getElementById('client-key').textContent = clientKey.substring(0, 10) + '...';

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ login ‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
        const sessionId = localStorage.getItem('tiktok_session_id');
        
        if (sessionId) {
            showLoggedIn();
            loadUserInfo(sessionId);
        } else {
            showNotLoggedIn();
        }

        function showLoggedIn() {
            document.getElementById('not-logged-in').style.display = 'none';
            document.getElementById('logged-in').style.display = 'block';
            document.getElementById('session-id').textContent = sessionId.substring(0, 16) + '...';
        }

        function showNotLoggedIn() {
            document.getElementById('not-logged-in').style.display = 'block';
            document.getElementById('logged-in').style.display = 'none';
        }

        async function loadUserInfo(sessionId) {
            try {
                const response = await fetch(`/api/tiktok/user/${sessionId}`);
                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.error || 'Failed to load user info');
                }

                // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
                if (data.data && data.data.user) {
                    const user = data.data.user;
                    document.getElementById('user-name').textContent = user.display_name || '-';
                    document.getElementById('user-openid').textContent = user.open_id || '-';
                    document.getElementById('user-unionid').textContent = user.union_id || '-';
        
                    if (user.avatar_url) {
                        document.getElementById('user-avatar').src = user.avatar_url;
                        document.getElementById('user-avatar').style.display = 'block';
                    }
                }

                document.getElementById('user-loading').style.display = 'none';
                document.getElementById('user-data').style.display = 'block';

            } catch (error) {
                console.error('Error loading user info:', error);
                document.getElementById('user-loading').style.display = 'none';
                document.getElementById('user-error').textContent = '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ: ' + error.message;
                document.getElementById('user-error').style.display = 'block';
            }
        }

        async function logout() {
            if (confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                const sessionId = localStorage.getItem('tiktok_session_id');
        
                // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API logout
                if (sessionId) {
                    try {
                        await fetch(`/api/tiktok/logout/${sessionId}`, { method: 'POST' });
                    } catch (error) {
                        console.error('Logout error:', error);
                    }
                }
        
                // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô localStorage
                localStorage.removeItem('tiktok_session_id');
                localStorage.removeItem('tiktok_open_id');
        
                // reload ‡∏´‡∏ô‡πâ‡∏≤
                window.location.reload();
            }
        }
    </script>
    <script src="/views/FrontStore/cookieConsent.js"></script>
</body>
</html>
