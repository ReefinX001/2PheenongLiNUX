<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ | 2 ‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á ‡πÇ‡∏°‡∏ö‡∏≤‡∏¢</title>
  <link rel="stylesheet" href="/views/FrontStore/styles.css?v=19">
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            'sf': ['SF Pro Display', 'system-ui', 'sans-serif'],
          },
          colors: {
            'gray-light': '#f8f9fa',
            'gray-lighter': '#e9ecef',
            'gray-medium': '#6c757d',
            'gray-dark': '#495057',
            'gray-darker': '#343a40'
          }
        }
      }
    };
  </script>
  <style>
    body { font-family: 'SF Pro Display', system-ui, sans-serif; }
    
    /* Video card styles */
    .card-video-top {
      border-radius: 12px 12px 0 0;
      background: #f8f9fa;
    }
    
    .card-video-top:hover {
      transform: scale(1.02);
      transition: transform 0.2s ease;
    }
    
    /* Responsive video controls */
    .card-video-top::-webkit-media-controls-panel {
      background-color: rgba(0, 0, 0, 0.1);
    }
    
    /* Video poster fallback */
    .card-video-top video {
      background-color: #f8f9fa;
    }
    
    /* Card hover effects for both image and video */
    .card:hover .card-img-top,
    .card:hover .card-video-top {
      transform: scale(1.02);
      transition: transform 0.2s ease;
    }
  </style>
</head>
<body class="bg-gray-light font-sf">
    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-container">
            <div class="nav-links">
                <a href="Promotions" class="nav-link">‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô</a>
                <a href="Product" class="nav-link">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a>
                <div class="nav-brand">
                    <a href="/" class="brand-link" title="‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å">
                        <img src="/views/FrontStore/Logo2png.png" alt="2‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á ‡πÇ‡∏°‡∏ö‡∏≤‡∏¢" class="brand-logo">
                    </a>
                </div>
                <a href="JoinUs" class="nav-link">‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</a>
                <a href="Contact" class="nav-link">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</a>
            </div>
        </div>
    </nav>

  <!-- Main Content -->
  <main class="bg-white py-5">
    <div class="container">
      <header class="text-center mb-5">
        <h1 class="display-5 fw-bold text-gray-800 mb-3">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h1>
        <div id="filterTabs" class="d-flex gap-2 justify-content-center flex-wrap mb-4"></div>
      </header>

      <div id="productsContainer"></div>
    </div>
  </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-main">
                <div class="footer-section">
                    <div class="footer-brand">
                        <img src="/views/FrontStore/Logo2png.png" alt="2‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á ‡πÇ‡∏°‡∏ö‡∏≤‡∏¢" class="footer-logo">
                        <h2 class="footer-title">2 ‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á ‡πÇ‡∏°‡∏ö‡∏≤‡∏¢</h2>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3 class="footer-contact-title">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</h3>
                    <div class="footer-contact">
                        <p class="company-name">‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó 2 ‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á ‡πÇ‡∏°‡∏ö‡∏≤‡∏¢ ‡∏à‡∏≥‡∏Å‡∏±‡∏î</p>
                        <p class="company-address">148/91 ‡∏ï‡∏≥‡∏ö‡∏• ‡∏£‡∏π‡∏™‡∏∞‡∏°‡∏¥‡πÅ‡∏• ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏õ‡∏±‡∏ï‡∏ï‡∏≤‡∏ô‡∏µ 94000</p>
                        <p class="company-phone">üìû 092 427 0769</p>
                        <p class="company-email">‚úâÔ∏è support@2pheenong.com</p>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3 class="footer-menu-title">2 ‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á ‡πÇ‡∏°‡∏ö‡∏≤‡∏¢</h3>
                    <div class="footer-menu">
                        <a href="/Promotions" class="footer-link">‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô</a>
                        <a href="/Contact" class="footer-link">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</a>
                        <a href="/terms" class="footer-link">‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</a>
                        <a href="/privacy" class="footer-link">‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</a>
                        <a href="#" onclick="if(cookieConsent) cookieConsent.showSettings(); return false;" class="footer-link">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∏‡∏Å‡∏Å‡∏µ‡πâ</a>
                    </div>
                </div>
            </div>
            
            <!-- Partner Logos Section -->
            <div class="footer-partners">
                <h3 class="partners-title">‡∏û‡∏±‡∏ô‡∏ò‡∏°‡∏¥‡∏ï‡∏£‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</h3>
                <div class="partner-logos">
                    <img src="/views/FrontStore/dbd_logo-20140312-175003.png" alt="DBD" class="partner-logo">
                    <img src="/views/FrontStore/ktc_logo.png" alt="KTC" class="partner-logo">
                    <img src="/views/FrontStore/images.png" alt="Partner" class="partner-logo">
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 2 ‡∏û‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á ‡πÇ‡∏°‡∏ö‡∏≤‡∏¢. ‡∏™‡∏á‡∏ß‡∏ô‡∏•‡∏¥‡∏Ç‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏£</p>
            </div>
        </div>
    </footer>

  <script>
    const THB = (n) => (n === null || n === undefined || isNaN(n) ? '-' : '‡∏ø' + Number(n).toLocaleString('th-TH'));
    const groupKeyCandidates = ['type','productType','category','categoryName','group','stockType'];

    function normalizeImageUrl(raw) {
      if (!raw) return '';
      // already absolute http(s)
      if (/^https?:\/\//i.test(raw)) return raw;
      // leading slash is absolute from domain
      if (raw.startsWith('/')) return raw;
      // common case: 'uploads/products/...' coming from API ‚Üí make absolute
      if (raw.startsWith('uploads/')) return '/' + raw;
      // some APIs return relative like 'products/..' inside uploads
      if (raw.startsWith('products/')) return '/uploads/' + raw;
      // else anchor at site root to avoid resolving under /views/FrontStore/
      return '/' + raw;
    }

    function deriveBrand(item) {
      const brandField = item.brand || item.maker || item.vendor || item.manufacturer;
      if (brandField) return String(brandField).trim();
      const name = String(item.name || '').toLowerCase();
      const map = [
        ['iphone', 'iPhone'],
        ['ipad', 'iPad'],
        ['samsung', 'Samsung'],
        ['galaxy', 'Samsung'],
        ['oppo', 'OPPO'],
        ['vivo', 'vivo'],
        ['xiaomi', 'Xiaomi'],
        ['redmi', 'Xiaomi'],
        ['realme', 'realme'],
        ['huawei', 'HUAWEI'],
        ['nothing', 'Nothing'],
        ['oneplus', 'OnePlus'],
        ['apple', 'Apple'],
        ['airpods', 'Apple Accessories'],
        ['watch', 'Apple Watch'],
        ['tv', 'Apple TV'],
      ];
      for (const [needle, label] of map) {
        if (name.includes(needle)) return label;
      }
      // fallback to category-style fields, else '‡∏≠‡∏∑‡πà‡∏ô‡πÜ'
      return item.type || item.productType || item.category || item.categoryName || item.group || item.stockType || '‡∏≠‡∏∑‡πà‡∏ô‡πÜ';
    }

    async function fetchJSON(url){
      const res = await fetch(url);
      try { return await res.json(); } catch { return null; }
    }

    async function loadData(){
      // Try combined pricing first; fall back to separate endpoints
      let pricingResp = await fetchJSON('/api/product-image/pricing');
      let cashOnly = null, instOnly = null;
      if(!pricingResp || pricingResp.success === false){
        cashOnly = await fetchJSON('/api/product-image/pricing/cash');
        instOnly = await fetchJSON('/api/product-image/pricing/installment');
      }
      const allItems = await fetchJSON('/api/product-image');

      // Normalize arrays
      const combinedPricing = pricingResp?.data || [];
      const cashList = pricingResp?.cash || cashOnly?.data || cashOnly || [];
      const instList = pricingResp?.installment || instOnly?.data || instOnly || [];
      const baseList = allItems?.data || allItems || [];

      // Index by name to merge prices
      const byName = new Map();
      const ensure = (name) => { if(!byName.has(name)) byName.set(name, { name }); return byName.get(name); };

      baseList.forEach(it => {
        const entry = ensure(it.name || it.productName || it.title || '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏ä‡∏∑‡πà‡∏≠');
        entry.image = normalizeImageUrl(it.image || it.thumbnail || it.thumbnailImage || entry.image || '');
        // Copy potential grouping fields
        groupKeyCandidates.forEach(k => { if(it[k] !== undefined) entry[k] = it[k]; });
      });

      // Combined pricing provides all relevant fields in one object
      combinedPricing.forEach(it => {
        const name = it.name || it.productName || it.title || it._id || '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏ä‡∏∑‡πà‡∏≠';
        const entry = ensure(name);
        entry.cash = isFinite(Number(it.price)) ? Number(it.price) : entry.cash;
        entry.downAmount = isFinite(Number(it.downAmount)) ? Number(it.downAmount) : entry.downAmount;
        entry.downInstallmentCount = isFinite(Number(it.downInstallmentCount)) ? Number(it.downInstallmentCount) : entry.downInstallmentCount;
        entry.downInstallment = isFinite(Number(it.downInstallment)) ? Number(it.downInstallment) : entry.downInstallment;
        entry.perMonth = isFinite(Number(it.payUseInstallment)) ? Number(it.payUseInstallment) : entry.perMonth;
        entry.installMonths = isFinite(Number(it.payUseInstallmentCount)) ? Number(it.payUseInstallmentCount) : entry.installMonths;
        if(!entry.image) entry.image = normalizeImageUrl(it.image || it.imageUrl || it.thumbnail);
        if(!entry.type) entry.type = deriveBrand(it);
      });

      cashList.forEach(it => {
        const name = it.name || it.productName || it.title || it._id || '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏ä‡∏∑‡πà‡∏≠';
        const entry = ensure(name);
        entry.cash = Number(it.cash || it.price || it.price_cash || it.amount || it.value || NaN);
        if(!entry.image) entry.image = normalizeImageUrl(it.image || it.thumbnail || '');
        groupKeyCandidates.forEach(k => { if(it[k] !== undefined && entry[k] === undefined) entry[k] = it[k]; });
      });

      instList.forEach(it => {
        const name = it.name || it.productName || it.title || it._id || '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏ä‡∏∑‡πà‡∏≠';
        const entry = ensure(name);
        // Prefer monthly (e.g., 10x), store bestMonth and perMonth
        entry.installMonths = Number(it.months || it.installmentMonths || it.term || it.tenor || 10);
        entry.perMonth = Number(it.perMonth || it.price_per_month || it.monthly || it.installment || NaN);
        entry.installTotal = Number(it.total || it.total_price || NaN);
        if(!entry.image) entry.image = normalizeImageUrl(it.image || it.thumbnail || '');
        groupKeyCandidates.forEach(k => { if(it[k] !== undefined && entry[k] === undefined) entry[k] = it[k]; });
      });

      // Build array
      const merged = Array.from(byName.values()).map(x => ({
        name: x.name,
        image: x.image,
        type: deriveBrand(x),
        cash: isFinite(x.cash) ? x.cash : null,
        perMonth: isFinite(x.perMonth) ? x.perMonth : null,
        installMonths: isFinite(x.installMonths) ? x.installMonths : (isFinite(x.perMonth) ? 10 : null),
        downAmount: isFinite(x.downAmount) ? x.downAmount : null,
        downInstallmentCount: isFinite(x.downInstallmentCount) ? x.downInstallmentCount : null,
        downInstallment: isFinite(x.downInstallment) ? x.downInstallment : null,
      }));

      return merged;
    }

    function buildTabs(groups){
      const tabs = document.getElementById('filterTabs');
      tabs.innerHTML = '';
      const allBtn = document.createElement('button');
      allBtn.className = 'btn btn-primary btn-sm rounded-pill px-3 me-2 mb-2 fw-medium active-tab';
      allBtn.textContent = '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î';
      allBtn.onclick = () => { setActiveTab(allBtn); renderSections(currentData); };
      tabs.appendChild(allBtn);
      groups.forEach(g => {
        const btn = document.createElement('button');
        btn.className = 'btn btn-outline-secondary btn-sm rounded-pill px-3 me-2 mb-2 fw-medium';
        btn.textContent = g;
        btn.onclick = () => { setActiveTab(btn); renderSections(currentData.filter(i => i.type === g), g); };
        tabs.appendChild(btn);
      });
    }

    function setActiveTab(activeBtn) {
      document.querySelectorAll('#filterTabs button').forEach(btn => {
        btn.className = 'btn btn-outline-secondary btn-sm rounded-pill px-3 me-2 mb-2 fw-medium';
      });
      activeBtn.className = 'btn btn-primary btn-sm rounded-pill px-3 me-2 mb-2 fw-medium active-tab';
    }

    function renderSections(data, singleGroup){
      const container = document.getElementById('productsContainer');
      container.innerHTML = '';

      const groups = singleGroup ? [singleGroup] : Array.from(new Set(data.map(i => i.type)));
      if (!data.length){
        container.innerHTML = '<div class="alert alert-info text-center">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</div>';
        return;
      }

      groups.forEach(group => {
        const section = document.createElement('section');
        section.className = 'mb-5';

        const header = document.createElement('div');
        header.className = 'd-flex align-items-center justify-content-between mb-4';
        header.innerHTML = `<h2 class="h4 fw-bold text-gray-800 mb-0">${group}</h2>`;
        section.appendChild(header);

        const grid = document.createElement('div');
        grid.className = 'row g-3';

        // Limit initial render per group for performance
        const items = data.filter(i => i.type === group);
        const initial = items.slice(0, 16);
        initial.forEach(item => {
          const col = document.createElement('div');
          col.className = 'col-lg-3 col-md-4 col-sm-6';
    
          const imgSrc = item.image || '/views/FrontStore/Logo2png.png';
    
          // Check if the media is a video (improved detection)
          const isVideo = imgSrc && (
            imgSrc.toLowerCase().includes('.mp4') ||
            imgSrc.toLowerCase().includes('.webm') ||
            imgSrc.toLowerCase().includes('.mov') ||
            imgSrc.toLowerCase().includes('.avi') ||
            imgSrc.toLowerCase().includes('video')
          );
    
          console.log('Item:', item.name, 'ImgSrc:', imgSrc, 'IsVideo:', isVideo); // Debug log
    
          const mediaElement = isVideo ?
            `<video class="card-video-top p-3" autoplay muted loop playsinline preload="metadata" 
                    style="height: 160px; width: 100%; object-fit: contain;" 
                    onloadstart="console.log('Video loading:', '${imgSrc}')"
                    onerror="console.error('Video error:', '${imgSrc}'); this.style.display='none'; this.nextElementSibling.style.display='block';">
               <source src="${imgSrc}" type="video/${imgSrc.split('.').pop().toLowerCase()}">
               Your browser does not support the video tag.
             </video>
             <img src="${item.thumbnail || '/views/FrontStore/Logo2png.png'}" alt="${item.name}" 
                  style="height: 160px; object-fit: contain; display: none;" loading="lazy" 
                  onerror="this.onerror=null;this.src='/views/FrontStore/Logo2png.png';"/>` :
            `<img class="card-img-top p-3" src="${imgSrc}" alt="${item.name}" loading="lazy" 
                 style="height: 160px; object-fit: contain;" 
                 onerror="this.onerror=null;this.src='/views/FrontStore/Logo2png.png';"/>`;
    
          col.innerHTML = `
            <div class="card border-0 shadow-sm h-100 hover:shadow-lg transition-all" style="border-radius: 16px;">
              ${mediaElement}
              <div class="card-body p-3">
                <h6 class="card-title fw-bold text-gray-800 mb-2">${item.name}</h6>
                <p class="card-text small text-gray-600 mb-2">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: ${item.type}</p>
                <div class="d-flex align-items-center justify-content-between mb-3">
                  <span class="fw-bold text-gray-800">${THB(item.cash)}</span>
                  <span class="text-primary small fw-medium">${item.perMonth ? THB(item.perMonth) + `/‡∏á‡∏ß‡∏î x ${item.installMonths || ''}` : '-'}</span>
                </div>
                <div class="row g-1 text-center small">
                  <div class="col-4">
                    <div class="bg-gray-light rounded-3 p-2">
                      <div class="text-gray-600" style="font-size: 10px;">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥</div>
                      <div class="fw-bold text-gray-800" style="font-size: 11px;">${item.downAmount ? THB(item.downAmount) : '-'}</div>
                    </div>
                  </div>
                  <div class="col-4">
                    <div class="bg-gray-light rounded-3 p-2">
                      <div class="text-gray-600" style="font-size: 10px;">‡∏á‡∏ß‡∏î</div>
                      <div class="fw-bold text-gray-800" style="font-size: 11px;">${item.downInstallmentCount || '-'}</div>
                    </div>
                  </div>
                  <div class="col-4">
                    <div class="bg-gray-light rounded-3 p-2">
                      <div class="text-gray-600" style="font-size: 10px;">‡∏ú‡πà‡∏≠‡∏ô/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
                      <div class="fw-bold text-gray-800" style="font-size: 11px;">${item.downInstallment ? THB(item.downInstallment) : '-'}</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          `;
          grid.appendChild(col);
        });

        if (items.length > initial.length) {
          const moreCol = document.createElement('div');
          moreCol.className = 'col-12 text-center mt-4';
          const moreBtn = document.createElement('button');
          moreBtn.className = 'btn btn-outline-primary rounded-pill px-4 fw-medium';
          moreBtn.textContent = `‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏° (${items.length - initial.length})`;
          moreBtn.onclick = () => {
            moreCol.remove();
            items.slice(initial.length).forEach(item => {
              const col = document.createElement('div');
              col.className = 'col-lg-3 col-md-4 col-sm-6';
    
              const imgSrc = item.image || '/views/FrontStore/Logo2png.png';
    
              // Check if the media is a video for lazy loaded items too (improved detection)
              const isVideo = imgSrc && (
                imgSrc.toLowerCase().includes('.mp4') ||
                imgSrc.toLowerCase().includes('.webm') ||
                imgSrc.toLowerCase().includes('.mov') ||
                imgSrc.toLowerCase().includes('.avi') ||
                imgSrc.toLowerCase().includes('video')
              );
    
              console.log('Lazy Item:', item.name, 'ImgSrc:', imgSrc, 'IsVideo:', isVideo); // Debug log
    
              const mediaElement = isVideo ?
                `<video class="card-video-top p-3" autoplay muted loop playsinline preload="metadata"
                        style="height: 160px; width: 100%; object-fit: contain;" 
                        onloadstart="console.log('Lazy Video loading:', '${imgSrc}')"
                        onerror="console.error('Lazy Video error:', '${imgSrc}'); this.style.display='none'; this.nextElementSibling.style.display='block';">
                   <source src="${imgSrc}" type="video/${imgSrc.split('.').pop().toLowerCase()}">
                   Your browser does not support the video tag.
                 </video>
                 <img src="${item.thumbnail || '/views/FrontStore/Logo2png.png'}" alt="${item.name}" 
                      style="height: 160px; object-fit: contain; display: none;" loading="lazy" 
                      onerror="this.onerror=null;this.src='/views/FrontStore/Logo2png.png';"/>` :
                `<img class="card-img-top p-3" src="${imgSrc}" alt="${item.name}" loading="lazy" 
                     style="height: 160px; object-fit: contain;" 
                     onerror="this.onerror=null;this.src='/views/FrontStore/Logo2png.png';"/>`;
    
              col.innerHTML = `
                <div class="card border-0 shadow-sm h-100 hover:shadow-lg transition-all" style="border-radius: 16px;">
                  ${mediaElement}
                  <div class="card-body p-3">
                    <h6 class="card-title fw-bold text-gray-800 mb-2">${item.name}</h6>
                    <p class="card-text small text-gray-600 mb-2">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: ${item.type}</p>
                    <div class="d-flex align-items-center justify-content-between mb-3">
                      <span class="fw-bold text-gray-800">${THB(item.cash)}</span>
                      <span class="text-primary small fw-medium">${item.perMonth ? THB(item.perMonth) + `/‡∏á‡∏ß‡∏î x ${item.installMonths || ''}` : '-'}</span>
                    </div>
                    <div class="row g-1 text-center small">
                      <div class="col-4">
                        <div class="bg-gray-light rounded-3 p-2">
                          <div class="text-gray-600" style="font-size: 10px;">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥</div>
                          <div class="fw-bold text-gray-800" style="font-size: 11px;">${item.downAmount ? THB(item.downAmount) : '-'}</div>
                        </div>
                      </div>
                      <div class="col-4">
                        <div class="bg-gray-light rounded-3 p-2">
                          <div class="text-gray-600" style="font-size: 10px;">‡∏á‡∏ß‡∏î</div>
                          <div class="fw-bold text-gray-800" style="font-size: 11px;">${item.downInstallmentCount || '-'}</div>
                        </div>
                      </div>
                      <div class="col-4">
                        <div class="bg-gray-light rounded-3 p-2">
                          <div class="text-gray-600" style="font-size: 10px;">‡∏ú‡πà‡∏≠‡∏ô/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
                          <div class="fw-bold text-gray-800" style="font-size: 11px;">${item.downInstallment ? THB(item.downInstallment) : '-'}</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              `;
              grid.appendChild(col);
            });
          };
          moreCol.appendChild(moreBtn);
          section.appendChild(moreCol);
        }

        section.appendChild(grid);
        container.appendChild(section);
      });
    }

    let currentData = [];
    (async function init(){
      try {
        currentData = await loadData();
        const groups = Array.from(new Set(currentData.map(i => i.type)));
        buildTabs(groups);
        renderSections(currentData);
      } catch (e) {
        console.error('Load products error', e);
        document.getElementById('productsContainer').innerHTML = '<div class="empty-note">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</div>';
      }
    })();
  </script>
  <script src="/views/FrontStore/cookieConsent.js"></script>
</body>
</html>


