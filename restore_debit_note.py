#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import re

# Read the file
with open('views/account/debit_note.html', 'r', encoding='utf-8', errors='ignore') as f:
    content = f.read()

# First, fix the HTML attribute quotes
# Fix meta tags
content = re.sub(r'<meta charset=UTF-8', '<meta charset="UTF-8"', content)
content = re.sub(r'<meta http-equiv=([^ >]+)', r'<meta http-equiv="\1"', content)
content = re.sub(r'<meta name=([^ >]+)', r'<meta name="\1"', content)
content = re.sub(r' content=([^ >]+)>', r' content="\1">', content)

# Fix link tags
content = re.sub(r'<link rel=([^ >]+)', r'<link rel="\1"', content)
content = re.sub(r' href=([^ >]+)( |>)', r' href="\1"\2', content)
content = re.sub(r' crossorigin>', r' crossorigin>', content)

# Fix script tags
content = re.sub(r'<script src=([^ >]+)', r'<script src="\1"', content)
content = re.sub(r' crossorigin>', r' crossorigin>', content)
content = re.sub(r' defer>', r' defer>', content)

# Fix other HTML attributes
content = re.sub(r' lang=th>', r' lang="th">', content)
content = re.sub(r' class=([^ >]+)>', r' class="\1">', content)
content = re.sub(r' id=([^ >]+)>', r' id="\1">', content)
content = re.sub(r' type=([^ >]+)>', r' type="\1">', content)
content = re.sub(r' value=([^ >]+)>', r' value="\1">', content)

# Fix the title and main Thai text issues
thai_replacements = {
    'ใบเพมี': 'บัญชี - ใบเพิ่มหนี้',
    'à¸šà¸±à¸Mà¸Šà¸µ': 'บัญชี',
    'à¸šà¸±à¸à¸Šà¸µ': 'บัญชี',
    'ผูใช': 'ผู้ใช้',
    'เซช': 'เซสชัน',
    'เขูระบบใม': 'เข้าสู่ระบบใหม่',
    
    # Navigation and UI elements
    'ออกAจากAระบบ': 'ออกจากระบบ',
    'à¸­à¸­à¸à¸ˆà¸²à¸à¸£à¸°à¸šà¸š': 'ออกจากระบบ',
    
    # Date related
    'วันที่ออกAใบเพิ่มหนี้': 'วันที่ออกใบเพิ่มหนี้',
    'วันที่ออกà¹ƒà¸šà¹€à¸žà¸´à¹ˆà¸¡à¸«à¸™à¸µà¹‰': 'วันที่ออกใบเพิ่มหนี้',
    'เลือกช่วงเวลา': 'เลือกช่วงเวลา',
    'à¹€à¸¥à¸·à¸­à¸à¸Šà¹ˆà¸§à¸‡à¹€à¸§à¸¥à¸²': 'เลือกช่วงเวลา',
    'วันที่เริ่มต้น': 'วันที่เริ่มต้น',
    'วันที่à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™': 'วันที่เริ่มต้น',
    'วันที่สิ้นสุด': 'วันที่สิ้นสุด',
    'วันที่à¸ªà¸´à¹‰à¸™à¸ªà¸¸à¸"': 'วันที่สิ้นสุด',
    
    # Status options
    'ทุกAสถานะ': 'ทุกสถานะ',
    'à¸—à¸¸à¸à¸ªà¸–à¸²à¸™à¸°': 'ทุกสถานะ',
    'อนุมัติ': 'อนุมัติ',
    'รอดำเนินการ': 'รอดำเนินการ',
    'à¸£à¸­à¸"à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£': 'รอดำเนินการ',
    'ปฏิเสธ': 'ปฏิเสธ',
    'à¸›à¸à¸´à¹€à¸ªà¸˜': 'ปฏิเสธ',
    
    # Buttons
    'ยกเลิก': 'ยกเลิก',
    'à¸¢à¸à¹€à¸¥à¸´à¸': 'ยกเลิก',
    'ยืนยัน': 'ยืนยัน',
    'à¸¢à¸·à¸™à¸¢à¸±à¸™': 'ยืนยัน',
    'ค้นหาขั้นสูง': 'ค้นหาขั้นสูง',
    
    # Table headers
    'ใบเพิ่มหนี้': 'ใบเพิ่มหนี้',
    'วันที่': 'วันที่',
    'สถานะ': 'สถานะ',
    'เลขที่ใบเพิ่มหนี้': 'เลขที่ใบเพิ่มหนี้',
    'สินค้า': 'สินค้า',
    'ยอดใบเพิ่มหนี้': 'ยอดใบเพิ่มหนี้',
    'ยก­à¸"ใบเพิ่มหนี้': 'ยอดใบเพิ่มหนี้',
    'ยอดคงเหลือ': 'ยอดคงเหลือ',
    'ยก­à¸"คงเหลือ': 'ยอดคงเหลือ',
    
    # Company names
    'บริษัท เวลล์ที อีทีเอส (ประเทศไทย) จำกัด': 'บริษัท เวลล์ที อีทีเอส (ประเทศไทย) จำกัด',
    'บริษัท เจเอเอส แอสเซ็ท จำกัด (มหาชน)': 'บริษัท เจเอเอส แอสเซ็ท จำกัด (มหาชน)',
    'จำà¸à¸±à¸"': 'จำกัด',
    'à¹à¸­à¸ªà¹€à¸‹à¹‡à¸—': 'แอสเซ็ท',
    
    # Service descriptions
    'ค่าบริการเพิ่มเติม': 'ค่าบริการเพิ่มเติม',
    'ค่าบริการà¸à¸²à¸£à¹€à¸žà¸´à¹ˆà¸¡à¹€à¸•à¸´à¸¡': 'ค่าบริการเพิ่มเติม',
    'ปรับปรุงราคาสินค้า': 'ปรับปรุงราคาสินค้า',
    'ค่าเช่าพื้นที่เพิ่มเติม': 'ค่าเช่าพื้นที่เพิ่มเติม',
    
    # Pagination
    'แสดง': 'แสดง',
    'à¹à¸ªà¸"à¸‡': 'แสดง',
    'รายการ': 'รายการ',
    'à¸£à¸²à¸¢à¸à¸²à¸£': 'รายการ',
    'หน้า': 'หน้า',
    'à¸«à¸™à¹‰à¸²': 'หน้า',
    
    # Alert messages
    'เซสชันหมดอายุ': 'เซสชันหมดอายุ',
    'à¹€à¸‹à¸ªà¸Šà¸±à¸™à¸«à¸¡à¸"à¸­à¸²à¸¢à¸¸': 'เซสชันหมดอายุ',
    'กรุณาเข้าสู่ระบบใหม่': 'กรุณาเข้าสู่ระบบใหม่',
    'à¸à¸£à¸¸à¸"à¸²à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸šà¹ƒà¸«à¸¡à¹ˆ': 'กรุณาเข้าสู่ระบบใหม่',
    'กรุณาตรวจสอบข้อมูลที่กรอก': 'กรุณาตรวจสอบข้อมูลที่กรอก',
    'เซสชันของคุณจะหมดอายุใน': 'เซสชันของคุณจะหมดอายุใน',
    'นาที': 'นาที',
    'ต้องการต่ออายุหรือไม่': 'ต้องการต่ออายุหรือไม่',
    'ออกจากระบบเรียบร้อยแล้ว': 'ออกจากระบบเรียบร้อยแล้ว',
    'กำลังพิมพ์รายงาน': 'กำลังพิมพ์รายงาน',
    'บันทึกการตั้งค่าเรียบร้อยแล้ว': 'บันทึกการตั้งค่าเรียบร้อยแล้ว',
    'กรุณาเลือกวันที่เริ่มต้นและวันที่สิ้นสุด': 'กรุณาเลือกวันที่เริ่มต้นและวันที่สิ้นสุด',
    'เลือกสินค้า/บริการ': 'เลือกสินค้า/บริการ',
    'บันทึกใบรับเงินมัดจำเรียบร้อยแล้ว': 'บันทึกใบรับเงินมัดจำเรียบร้อยแล้ว',
    
    # Comments
    'จุดปล่อยเมนู': 'จุดปล่อยเมนู',
    'เพิ่มส่วนแสดงข้อมูลผู้ใช้': 'เพิ่มส่วนแสดงข้อมูลผู้ใช้',
    'ส่วนค้นหาและตัวกรอง': 'ส่วนค้นหาและตัวกรอง',
    'ตาราง': 'ตาราง',
}

# Apply Thai text replacements
for old, new in thai_replacements.items():
    content = content.replace(old, new)

# Clean up any remaining corrupted UTF-8 patterns
content = re.sub(r'à¸[^ <>"\']+', '', content)
content = re.sub(r'à¹[^ <>"\']+', '', content)

# Remove any standalone 'A' characters between Thai text
content = re.sub(r'([ก-๙])A([ก-๙])', r'\1\2', content)

# Write the fixed content back
with open('views/account/debit_note.html', 'w', encoding='utf-8') as f:
    f.write(content)

print("HTML structure and Thai text have been restored!")