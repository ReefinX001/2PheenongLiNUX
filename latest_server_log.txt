[TAILING] Tailing last 200 lines for [server] process (change the value with --lines option)
C:\Users\Administrator\.pm2\logs\server-error.log last 200 lines:
0|server   |     'C:\\Users\\Administrator\\Desktop\\Project 3\\my-accounting-app\\server.js'
0|server   |   ]
0|server   | }
0|server   | Error: Cannot find module '../models/BranchStock'
0|server   | Require stack:
0|server   | - C:\Users\Administrator\Desktop\Project 3\my-accounting-app\routes\installmentOrderRoutes.js
0|server   | - C:\Users\Administrator\Desktop\Project 3\my-accounting-app\server.js
0|server   |     at Module._resolveFilename (node:internal/modules/cjs/loader:1140:15)
0|server   |     at Hook._require.Module.require (C:\Users\Administrator\AppData\Roaming\npm\node_modules\pm2\node_modules\require-in-the-middle\index.js:81:25)
0|server   |     at require (node:internal/modules/helpers:177:18)
0|server   |     at Object.<anonymous> (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\routes\installmentOrderRoutes.js:13:21)
0|server   |     at Module._compile (node:internal/modules/cjs/loader:1364:14)
0|server   |     at Module._extensions..js (node:internal/modules/cjs/loader:1422:10)
0|server   |     at Module.load (node:internal/modules/cjs/loader:1203:32)
0|server   |     at Module._load (node:internal/modules/cjs/loader:1019:12)
0|server   |     at Module.require (node:internal/modules/cjs/loader:1231:19)
0|server   |     at Hook._require.Module.require (C:\Users\Administrator\AppData\Roaming\npm\node_modules\pm2\node_modules\require-in-the-middle\index.js:101:39) {
0|server   |   code: 'MODULE_NOT_FOUND',
0|server   |   requireStack: [
0|server   |     'C:\\Users\\Administrator\\Desktop\\Project 3\\my-accounting-app\\routes\\installmentOrderRoutes.js',
0|server   |     'C:\\Users\\Administrator\\Desktop\\Project 3\\my-accounting-app\\server.js'
0|server   |   ]
0|server   | }
0|server   | Error: Cannot find module '../models/BranchStock'
0|server   | Require stack:
0|server   | - C:\Users\Administrator\Desktop\Project 3\my-accounting-app\routes\installmentOrderRoutes.js
0|server   | - C:\Users\Administrator\Desktop\Project 3\my-accounting-app\server.js
0|server   |     at Module._resolveFilename (node:internal/modules/cjs/loader:1140:15)
0|server   |     at Hook._require.Module.require (C:\Users\Administrator\AppData\Roaming\npm\node_modules\pm2\node_modules\require-in-the-middle\index.js:81:25)
0|server   |     at require (node:internal/modules/helpers:177:18)
0|server   |     at Object.<anonymous> (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\routes\installmentOrderRoutes.js:13:21)
0|server   |     at Module._compile (node:internal/modules/cjs/loader:1364:14)
0|server   |     at Module._extensions..js (node:internal/modules/cjs/loader:1422:10)
0|server   |     at Module.load (node:internal/modules/cjs/loader:1203:32)
0|server   |     at Module._load (node:internal/modules/cjs/loader:1019:12)
0|server   |     at Module.require (node:internal/modules/cjs/loader:1231:19)
0|server   |     at Hook._require.Module.require (C:\Users\Administrator\AppData\Roaming\npm\node_modules\pm2\node_modules\require-in-the-middle\index.js:101:39) {
0|server   |   code: 'MODULE_NOT_FOUND',
0|server   |   requireStack: [
0|server   |     'C:\\Users\\Administrator\\Desktop\\Project 3\\my-accounting-app\\routes\\installmentOrderRoutes.js',
0|server   |     'C:\\Users\\Administrator\\Desktop\\Project 3\\my-accounting-app\\server.js'
0|server   |   ]
0|server   | }
0|server   | Error: Cannot find module '../models/BranchStock'
0|server   | Require stack:
0|server   | - C:\Users\Administrator\Desktop\Project 3\my-accounting-app\routes\installmentOrderRoutes.js
0|server   | - C:\Users\Administrator\Desktop\Project 3\my-accounting-app\server.js
0|server   |     at Module._resolveFilename (node:internal/modules/cjs/loader:1140:15)
0|server   |     at Hook._require.Module.require (C:\Users\Administrator\AppData\Roaming\npm\node_modules\pm2\node_modules\require-in-the-middle\index.js:81:25)
0|server   |     at require (node:internal/modules/helpers:177:18)
0|server   |     at Object.<anonymous> (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\routes\installmentOrderRoutes.js:13:21)
0|server   |     at Module._compile (node:internal/modules/cjs/loader:1364:14)
0|server   |     at Module._extensions..js (node:internal/modules/cjs/loader:1422:10)
0|server   |     at Module.load (node:internal/modules/cjs/loader:1203:32)
0|server   |     at Module._load (node:internal/modules/cjs/loader:1019:12)
0|server   |     at Module.require (node:internal/modules/cjs/loader:1231:19)
0|server   |     at Hook._require.Module.require (C:\Users\Administrator\AppData\Roaming\npm\node_modules\pm2\node_modules\require-in-the-middle\index.js:101:39) {
0|server   |   code: 'MODULE_NOT_FOUND',
0|server   |   requireStack: [
0|server   |     'C:\\Users\\Administrator\\Desktop\\Project 3\\my-accounting-app\\routes\\installmentOrderRoutes.js',
0|server   |     'C:\\Users\\Administrator\\Desktop\\Project 3\\my-accounting-app\\server.js'
0|server   |   ]
0|server   | }
0|server   | Error: Cannot find module '../models/BranchStock'
0|server   | Require stack:
0|server   | - C:\Users\Administrator\Desktop\Project 3\my-accounting-app\routes\installmentOrderRoutes.js
0|server   | - C:\Users\Administrator\Desktop\Project 3\my-accounting-app\server.js
0|server   |     at Module._resolveFilename (node:internal/modules/cjs/loader:1140:15)
0|server   |     at Hook._require.Module.require (C:\Users\Administrator\AppData\Roaming\npm\node_modules\pm2\node_modules\require-in-the-middle\index.js:81:25)
0|server   |     at require (node:internal/modules/helpers:177:18)
0|server   |     at Object.<anonymous> (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\routes\installmentOrderRoutes.js:13:21)
0|server   |     at Module._compile (node:internal/modules/cjs/loader:1364:14)
0|server   |     at Module._extensions..js (node:internal/modules/cjs/loader:1422:10)
0|server   |     at Module.load (node:internal/modules/cjs/loader:1203:32)
0|server   |     at Module._load (node:internal/modules/cjs/loader:1019:12)
0|server   |     at Module.require (node:internal/modules/cjs/loader:1231:19)
0|server   |     at Hook._require.Module.require (C:\Users\Administrator\AppData\Roaming\npm\node_modules\pm2\node_modules\require-in-the-middle\index.js:101:39) {
0|server   |   code: 'MODULE_NOT_FOUND',
0|server   |   requireStack: [
0|server   |     'C:\\Users\\Administrator\\Desktop\\Project 3\\my-accounting-app\\routes\\installmentOrderRoutes.js',
0|server   |     'C:\\Users\\Administrator\\Desktop\\Project 3\\my-accounting-app\\server.js'
0|server   |   ]
0|server   | }
0|server   | Error: Cannot find module '../models/BranchStock'
0|server   | Require stack:
0|server   | - C:\Users\Administrator\Desktop\Project 3\my-accounting-app\routes\installmentOrderRoutes.js
0|server   | - C:\Users\Administrator\Desktop\Project 3\my-accounting-app\server.js
0|server   |     at Module._resolveFilename (node:internal/modules/cjs/loader:1140:15)
0|server   |     at Hook._require.Module.require (C:\Users\Administrator\AppData\Roaming\npm\node_modules\pm2\node_modules\require-in-the-middle\index.js:81:25)
0|server   |     at require (node:internal/modules/helpers:177:18)
0|server   |     at Object.<anonymous> (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\routes\installmentOrderRoutes.js:13:21)
0|server   |     at Module._compile (node:internal/modules/cjs/loader:1364:14)
0|server   |     at Module._extensions..js (node:internal/modules/cjs/loader:1422:10)
0|server   |     at Module.load (node:internal/modules/cjs/loader:1203:32)
0|server   |     at Module._load (node:internal/modules/cjs/loader:1019:12)
0|server   |     at Module.require (node:internal/modules/cjs/loader:1231:19)
0|server   |     at Hook._require.Module.require (C:\Users\Administrator\AppData\Roaming\npm\node_modules\pm2\node_modules\require-in-the-middle\index.js:101:39) {
0|server   |   code: 'MODULE_NOT_FOUND',
0|server   |   requireStack: [
0|server   |     'C:\\Users\\Administrator\\Desktop\\Project 3\\my-accounting-app\\routes\\installmentOrderRoutes.js',
0|server   |     'C:\\Users\\Administrator\\Desktop\\Project 3\\my-accounting-app\\server.js'
0|server   |   ]
0|server   | }
0|server   | Error: Cannot find module '../models/BranchStock'
0|server   | Require stack:
0|server   | - C:\Users\Administrator\Desktop\Project 3\my-accounting-app\routes\installmentOrderRoutes.js
0|server   | - C:\Users\Administrator\Desktop\Project 3\my-accounting-app\server.js
0|server   |     at Module._resolveFilename (node:internal/modules/cjs/loader:1140:15)
0|server   |     at Hook._require.Module.require (C:\Users\Administrator\AppData\Roaming\npm\node_modules\pm2\node_modules\require-in-the-middle\index.js:81:25)
0|server   |     at require (node:internal/modules/helpers:177:18)
0|server   |     at Object.<anonymous> (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\routes\installmentOrderRoutes.js:13:21)
0|server   |     at Module._compile (node:internal/modules/cjs/loader:1364:14)
0|server   |     at Module._extensions..js (node:internal/modules/cjs/loader:1422:10)
0|server   |     at Module.load (node:internal/modules/cjs/loader:1203:32)
0|server   |     at Module._load (node:internal/modules/cjs/loader:1019:12)
0|server   |     at Module.require (node:internal/modules/cjs/loader:1231:19)
0|server   |     at Hook._require.Module.require (C:\Users\Administrator\AppData\Roaming\npm\node_modules\pm2\node_modules\require-in-the-middle\index.js:101:39) {
0|server   |   code: 'MODULE_NOT_FOUND',
0|server   |   requireStack: [
0|server   |     'C:\\Users\\Administrator\\Desktop\\Project 3\\my-accounting-app\\routes\\installmentOrderRoutes.js',
0|server   |     'C:\\Users\\Administrator\\Desktop\\Project 3\\my-accounting-app\\server.js'
0|server   |   ]
0|server   | }
0|server   | Error: Cannot find module '../models/BranchStock'
0|server   | Require stack:
0|server   | - C:\Users\Administrator\Desktop\Project 3\my-accounting-app\routes\installmentOrderRoutes.js
0|server   | - C:\Users\Administrator\Desktop\Project 3\my-accounting-app\server.js
0|server   |     at Module._resolveFilename (node:internal/modules/cjs/loader:1140:15)
0|server   |     at Hook._require.Module.require (C:\Users\Administrator\AppData\Roaming\npm\node_modules\pm2\node_modules\require-in-the-middle\index.js:81:25)
0|server   |     at require (node:internal/modules/helpers:177:18)
0|server   |     at Object.<anonymous> (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\routes\installmentOrderRoutes.js:13:21)
0|server   |     at Module._compile (node:internal/modules/cjs/loader:1364:14)
0|server   |     at Module._extensions..js (node:internal/modules/cjs/loader:1422:10)
0|server   |     at Module.load (node:internal/modules/cjs/loader:1203:32)
0|server   |     at Module._load (node:internal/modules/cjs/loader:1019:12)
0|server   |     at Module.require (node:internal/modules/cjs/loader:1231:19)
0|server   |     at Hook._require.Module.require (C:\Users\Administrator\AppData\Roaming\npm\node_modules\pm2\node_modules\require-in-the-middle\index.js:101:39) {
0|server   |   code: 'MODULE_NOT_FOUND',
0|server   |   requireStack: [
0|server   |     'C:\\Users\\Administrator\\Desktop\\Project 3\\my-accounting-app\\routes\\installmentOrderRoutes.js',
0|server   |     'C:\\Users\\Administrator\\Desktop\\Project 3\\my-accounting-app\\server.js'
0|server   |   ]
0|server   | }
0|server   | Error: Cannot find module '../models/BranchStock'
0|server   | Require stack:
0|server   | - C:\Users\Administrator\Desktop\Project 3\my-accounting-app\routes\installmentOrderRoutes.js
0|server   | - C:\Users\Administrator\Desktop\Project 3\my-accounting-app\server.js
0|server   |     at Module._resolveFilename (node:internal/modules/cjs/loader:1140:15)
0|server   |     at Hook._require.Module.require (C:\Users\Administrator\AppData\Roaming\npm\node_modules\pm2\node_modules\require-in-the-middle\index.js:81:25)
0|server   |     at require (node:internal/modules/helpers:177:18)
0|server   |     at Object.<anonymous> (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\routes\installmentOrderRoutes.js:13:21)
0|server   |     at Module._compile (node:internal/modules/cjs/loader:1364:14)
0|server   |     at Module._extensions..js (node:internal/modules/cjs/loader:1422:10)
0|server   |     at Module.load (node:internal/modules/cjs/loader:1203:32)
0|server   |     at Module._load (node:internal/modules/cjs/loader:1019:12)
0|server   |     at Module.require (node:internal/modules/cjs/loader:1231:19)
0|server   |     at Hook._require.Module.require (C:\Users\Administrator\AppData\Roaming\npm\node_modules\pm2\node_modules\require-in-the-middle\index.js:101:39) {
0|server   |   code: 'MODULE_NOT_FOUND',
0|server   |   requireStack: [
0|server   |     'C:\\Users\\Administrator\\Desktop\\Project 3\\my-accounting-app\\routes\\installmentOrderRoutes.js',
0|server   |     'C:\\Users\\Administrator\\Desktop\\Project 3\\my-accounting-app\\server.js'
0|server   |   ]
0|server   | }
0|server   | (node:7016) [MONGOOSE] Warning: Duplicate schema index on {"personalInfo.phone":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
0|server   | (Use `node --trace-warnings ...` to show where the warning was created)
0|server   | (node:7016) [MONGOOSE] Warning: Duplicate schema index on {"depositReceiptId":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
0|server   | (node:7016) [MONGOOSE] Warning: Duplicate schema index on {"expiresAt":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
0|server   | (node:7016) [MONGOOSE] Warning: Duplicate schema index on {"receiptNumber":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
0|server   | (node:7016) [MONGOOSE] Warning: Duplicate schema index on {"assetNumber":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
0|server   | (node:7016) [MONGOOSE] Warning: Duplicate schema index on {"name":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
0|server   | (node:7016) [MONGOOSE] Warning: Duplicate schema index on {"taxInvoiceNumber":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
0|server   | (node:7016) [MONGOOSE] Warning: Duplicate schema index on {"receiptNumber":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
0|server   | (node:7016) [MONGOOSE] Warning: Duplicate schema index on {"documentNumber":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
0|server   | (node:7016) [MONGOOSE] Warning: Duplicate schema index on {"slug":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
0|server   | ⚠️ Redis not available (running without Redis): Redis is already connecting/connected
0|server   | ❌ Error using DocumentNumberSystem, falling back to legacy format: TypeError: Cannot read properties of undefined (reading 'generateQuotationNumber')
0|server   |     at exports.createQuotation (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\controllers\quotationController.js:196:52)
0|server   |     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
0|server   | ⚠️ Firebase Admin SDK not initialized, skipping sync
0|server   | ⚠️ Receipt Voucher sync failed: fetch failed
0|server   | ⚠️ A4PDF: No payment/financial data received
0|server   | ⚠️ Receipt Voucher sync error: fetch failed
0|server   | ⚠️ A4PDF: No payment/financial data received
0|server   | ❌ Quotation PDF generation failed, falling back to controller: TypeError: Only absolute URLs are supported
0|server   |     at getNodeRequestOptions (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\node_modules\node-fetch\lib\index.js:1327:9)
0|server   |     at C:\Users\Administrator\Desktop\Project 3\my-accounting-app\node_modules\node-fetch\lib\index.js:1450:19
0|server   |     at new Promise (<anonymous>)
0|server   |     at fetch (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\node_modules\node-fetch\lib\index.js:1447:9)
0|server   |     at EnhancedEmailService.generateQuotationPdf (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\services\enhancedEmailService.js:454:30)
0|server   |     at EnhancedEmailService.generateEnhancedPdfAttachments (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\services\enhancedEmailService.js:372:38)
0|server   |     at EnhancedEmailService.sendInstallmentEmailEnhanced (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\services\enhancedEmailService.js:168:34)
0|server   |     at C:\Users\Administrator\Desktop\Project 3\my-accounting-app\routes\enhancedEmailRoutes.js:54:47
0|server   |     at Layer.handle [as handle_request] (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\node_modules\express\lib\router\layer.js:95:5)
0|server   |     at next (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\node_modules\express\lib\router\route.js:149:13)
0|server   |     at Route.dispatch (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\node_modules\express\lib\router\route.js:119:3)
0|server   |     at Layer.handle [as handle_request] (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\node_modules\express\lib\router\layer.js:95:5)
0|server   |     at C:\Users\Administrator\Desktop\Project 3\my-accounting-app\node_modules\express\lib\router\index.js:284:15
0|server   |     at Function.process_params (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\node_modules\express\lib\router\index.js:346:12)
0|server   |     at next (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\node_modules\express\lib\router\index.js:280:10)
0|server   |     at Function.handle (C:\Users\Administrator\Desktop\Project 3\my-accounting-app\node_modules\express\lib\router\index.js:175:3)

C:\Users\Administrator\.pm2\logs\server-out.log last 200 lines:
0|server   |     'order_number',    'validUntil',
0|server   |     'customer',        'invoiceNumber',
0|server   |     'receiptNumber',   'salesperson'
0|server   |   ]
0|server   | }
0|server   | 🖼️ loadImageBuffer: No URL provided
0|server   | 🖼️ loadImageBuffer: No URL provided
0|server   | 🖼️ loadImageBuffer: No URL provided
0|server   | 🖼️ loadImageBuffer called with: string /uploads/S__15892486-Photoroom.png
0|server   | 🖼️ Found upload file: C:\Users\Administrator\Desktop\Project 3\my-accounting-app\uploads\S__15892486-Photoroom.png
0|server   | 🖋️ Signature loading results: {
0|server   |   customer: 'Failed',
0|server   |   salesperson: 'Failed',
0|server   |   authorized: 'Failed',
0|server   |   companyStamp: 'OK'
0|server   | }
0|server   | 🔍 QuotationPDF Raw signature data received: {
0|server   |   customerSignature: 'EMPTY',
0|server   |   customerSignatureUrl: 'EMPTY',
0|server   |   employeeSignature: 'EMPTY',
0|server   |   salespersonSignatureUrl: 'EMPTY',
0|server   |   authorizedSignature: 'EMPTY',
0|server   |   authorizedSignatureUrl: 'EMPTY'
0|server   | }
0|server   | 🖋️ QuotationPDF Signature Buffers: {
0|server   |   customer: 'NULL',
0|server   |   salesperson: 'NULL',
0|server   |   authorized: 'NULL',
0|server   |   companyStamp: 'OK'
0|server   | }
0|server   | 📄 No valid quotation number found, generating new one...
0|server   | 📄 Generated new quotation number: QT-680831-039
0|server   | 💰 QuotationPDF Document Fee Calculation: {
0|server   |   orderDocFee: 150,
0|server   |   step3DocFee: undefined,
0|server   |   fallbackDocFee: 'N/A',
0|server   |   finalDocFee: 150,
0|server   |   orderType: 'QUOTATION',
0|server   |   quotationNumber: 'QT-680831-039',
0|server   |   invoiceNumber: 'undefined'
0|server   | }
0|server   | 🔍 QuotationPDF Tax Debug: {
0|server   |   taxType: 'none',
0|server   |   documentType: undefined,
0|server   |   docFee: 150,
0|server   |   originalData: { taxType: 'none', vatAmount: 0, docFee: 150 }
0|server   | }
0|server   | 💰 QuotationPDF Price Calculation (updated to match InvoicePDF): {
0|server   |   itemsSubtotal: 0,
0|server   |   docFee: 150,
0|server   |   shipFee: 0,
0|server   |   vatTotal: 0,
0|server   |   taxType: 'none',
0|server   |   summary: { beforeTax: 150, tax: 0, netTotal: 150 },
0|server   |   grandTotal: 150
0|server   | }
0|server   | 🔍 QuotationPDF Debug - Number fields received: {
0|server   |   quotationNumber: 'QT-680831-039',
0|server   |   quotationNo: 'QT-680831-039',
0|server   |   order_number: 'QT-680831-039',
0|server   |   number: undefined,
0|server   |   _id: undefined,
0|server   |   selectedValue: 'QT-680831-039'
0|server   | }
0|server   | 🤖 AutoApproval: Processing all pending requests...
0|server   | 🤖 AutoApproval: Processing all pending requests...
0|server   | IP Check: {
0|server   |   username: 'admin',
0|server   |   currentIP: '2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3',
0|server   |   sessionIP: '2403:6200:8883:192f:4cdb:83e6:809b:b5a3',
0|server   |   headers: {
0|server   |     'x-forwarded-for': '2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3',
0|server   |     'x-real-ip': undefined,
0|server   |     'cf-connecting-ip': '2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3',
0|server   |     'req.ip': '2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3'
0|server   |   }
0|server   | }
0|server   | [PrinterProxy] Checking status for branch 00000
0|server   | info: 2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3 - - [31/Aug/2025:11:53:32 +0000] "GET /api/printer/status HTTP/1.1" 200 390 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36" {"service":"my-accounting-app","timestamp":"2025-08-31T11:53:32.590Z"}
0|server   | 🤖 AutoApproval: Processing all pending requests...
0|server   | info: 2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3 - - [31/Aug/2025:11:53:41 +0000] "GET /step1?branch=00000&name=%E0%B8%AA%E0%B8%B3%E0%B8%99%E0%B8%B1%E0%B8%81%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B9%83%E0%B8%AB%E0%B8%8D%E0%B9%88 HTTP/1.1" 304 - "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36" {"service":"my-accounting-app","timestamp":"2025-08-31T11:53:41.807Z"}
0|server   | info: 2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3 - - [31/Aug/2025:11:53:42 +0000] "GET /api/branch HTTP/1.1" 304 - "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36" {"service":"my-accounting-app","timestamp":"2025-08-31T11:53:42.195Z"}
0|server   | IP Check: {
0|server   |   username: 'admin',
0|server   |   currentIP: '2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3',
0|server   |   sessionIP: '2403:6200:8883:192f:4cdb:83e6:809b:b5a3',
0|server   |   headers: {
0|server   |     'x-forwarded-for': '2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3',
0|server   |     'x-real-ip': undefined,
0|server   |     'cf-connecting-ip': '2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3',
0|server   |     'req.ip': '2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3'
0|server   |   }
0|server   | }
0|server   | info: 2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3 - - [31/Aug/2025:11:53:42 +0000] "GET /api/users/me HTTP/1.1" 304 - "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36" {"service":"my-accounting-app","timestamp":"2025-08-31T11:53:42.320Z"}
0|server   | 🔍 API getAllImages called
0|server   | 📋 Query params: {}
0|server   | 👤 User from token: No user
0|server   | 🔢 Pagination params: { page: 1, limit: null, skip: 0 }
0|server   | 🗄️ MongoDB connection state: 1
0|server   | 🗄️ Database name: test
0|server   | 📊 Counting total documents...
0|server   | 📊 Total documents in ProductImage collection: 99
0|server   | 📥 Fetching product images...
0|server   | 📥 Retrieved product images count: 99
0|server   | 📥 Sample product image: {
0|server   |   _id: new ObjectId('685cf14715ec2c5017e86022'),
0|server   |   name: 'iPhone 13 256GB Midnight',
0|server   |   image: 'uploads\\products\\1750921543015-887358389.jpg',
0|server   |   brand: 'APPLE',
0|server   |   price: 14900,
0|server   |   downAmount: 20000,
0|server   |   downInstallmentCount: 10,
0|server   |   downInstallment: 3000,
0|server   |   creditThreshold: 0,
0|server   |   payUseInstallmentCount: 0,
0|server   |   payUseInstallment: 0,
0|server   |   pricePayOff: 17490,
0|server   |   docFee: 0,
0|server   |   purchaseType: [ 'cash', 'installment' ],
0|server   |   productType: 'mobile',
0|server   |   stockType: 'imei',
0|server   |   createdAt: 2025-06-26T07:05:43.113Z,
0|server   |   updatedAt: 2025-07-27T09:36:53.314Z,
0|server   |   __v: 0
0|server   | }
0|server   | info: 2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3 - - [31/Aug/2025:11:53:42 +0000] "GET /api/product-image HTTP/1.1" 304 - "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36" {"service":"my-accounting-app","timestamp":"2025-08-31T11:53:42.939Z"}
0|server   | info: 2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3 - - [31/Aug/2025:11:53:44 +0000] "GET /api/branch-stock/taxType?branch_code=00000&purchaseType=installment&verified=true HTTP/1.1" 304 - "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36" {"service":"my-accounting-app","timestamp":"2025-08-31T11:53:44.909Z"}
0|server   | info: 2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3 - - [31/Aug/2025:11:53:45 +0000] "GET /api/branch-stock/taxType?branch_code=00000&purchaseType=installment&verified=true HTTP/1.1" 304 - "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36" {"service":"my-accounting-app","timestamp":"2025-08-31T11:53:45.150Z"}
0|server   | 🔍 API getAllImages called
0|server   | 📋 Query params: {}
0|server   | 👤 User from token: No user
0|server   | 🔢 Pagination params: { page: 1, limit: null, skip: 0 }
0|server   | 🗄️ MongoDB connection state: 1
0|server   | 🗄️ Database name: test
0|server   | 📊 Counting total documents...
0|server   | 🔍 Searching stock: branch=00000, query="SL6H3FK3Q7T", type=all
0|server   | 📊 Total documents in ProductImage collection: 99
0|server   | 📥 Fetching product images...
0|server   | ✅ Found 1 results for query "SL6H3FK3Q7T"
0|server   | info: 2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3 - - [31/Aug/2025:11:53:48 +0000] "GET /api/branch-stock/search?branch_code=00000&q=SL6H3FK3Q7T&type=all&purchaseType=installment HTTP/1.1" 304 - "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36" {"service":"my-accounting-app","timestamp":"2025-08-31T11:53:48.468Z"}
0|server   | info: 2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3 - - [31/Aug/2025:11:53:48 +0000] "GET /api/branch-stock/taxType?branch_code=00000&purchaseType=installment&verified=true HTTP/1.1" 304 - "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36" {"service":"my-accounting-app","timestamp":"2025-08-31T11:53:48.542Z"}
0|server   | 📥 Retrieved product images count: 99
0|server   | 📥 Sample product image: {
0|server   |   _id: new ObjectId('685cf14715ec2c5017e86022'),
0|server   |   name: 'iPhone 13 256GB Midnight',
0|server   |   image: 'uploads\\products\\1750921543015-887358389.jpg',
0|server   |   brand: 'APPLE',
0|server   |   price: 14900,
0|server   |   downAmount: 20000,
0|server   |   downInstallmentCount: 10,
0|server   |   downInstallment: 3000,
0|server   |   creditThreshold: 0,
0|server   |   payUseInstallmentCount: 0,
0|server   |   payUseInstallment: 0,
0|server   |   pricePayOff: 17490,
0|server   |   docFee: 0,
0|server   |   purchaseType: [ 'cash', 'installment' ],
0|server   |   productType: 'mobile',
0|server   |   stockType: 'imei',
0|server   |   createdAt: 2025-06-26T07:05:43.113Z,
0|server   |   updatedAt: 2025-07-27T09:36:53.314Z,
0|server   |   __v: 0
0|server   | }
0|server   | info: 2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3 - - [31/Aug/2025:11:53:48 +0000] "GET /api/product-image HTTP/1.1" 304 - "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36" {"service":"my-accounting-app","timestamp":"2025-08-31T11:53:48.575Z"}
0|server   | 🤖 AutoApproval: Processing all pending requests...
0|server   | IP Check: {
0|server   |   username: 'admin',
0|server   |   currentIP: '2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3',
0|server   |   sessionIP: '2403:6200:8883:192f:4cdb:83e6:809b:b5a3',
0|server   |   headers: {
0|server   |     'x-forwarded-for': '2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3',
0|server   |     'x-real-ip': undefined,
0|server   |     'cf-connecting-ip': '2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3',
0|server   |     'req.ip': '2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3'
0|server   |   }
0|server   | }
0|server   | [PrinterProxy] Checking status for branch 00000
0|server   | info: 2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3 - - [31/Aug/2025:11:53:54 +0000] "GET /api/printer/status HTTP/1.1" 200 390 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36" {"service":"my-accounting-app","timestamp":"2025-08-31T11:53:54.484Z"}
0|server   | 🤖 AutoApproval: Processing all pending requests...
0|server   | 🤖 Running fallback auto-approval check...
0|server   | 🤖 AutoApproval: Processing all pending requests...
0|server   | 🤖 Fallback check: ไม่มีคำขอที่ต้องอนุมัติ (76ms)
0|server   | 🤖 AutoApproval: Processing all pending requests...
0|server   | info: 2403:6200:8883:192f:1cd3:c7e2:b5e3:cdf3 - - [31/Aug/2025:11:54:10 +0000] "POST /api/enhanced-email/send-installment-enhanced HTTP/1.1" - - "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36" {"service":"my-accounting-app","timestamp":"2025-08-31T11:54:10.712Z"}
0|server   | 🤖 AutoApproval: Processing all pending requests...
0|server   | 🤖 AutoApproval: Processing all pending requests...
0|server   | 🤖 AutoApproval: Processing all pending requests...
0|server   | 🤖 AutoApproval: Processing all pending requests...
0|server   | 💓 Health check - Server is running
0|server   | 🤖 AutoApproval: Processing all pending requests...
0|server   | 🤖 AutoApproval: Processing all pending requests...
0|server   | 🤖 AutoApproval: Processing all pending requests...
0|server   | 🤖 AutoApproval: Processing all pending requests...
0|server   | 🤖 AutoApproval: Processing all pending requests...
0|server   | 🤖 AutoApproval: Processing all pending requests...
0|server   | 🤖 AutoApproval: Processing all pending requests...
0|server   | 🤖 Running fallback auto-approval check...
0|server   | 🤖 AutoApproval: Processing all pending requests...
0|server   | 🤖 Fallback check: ไม่มีคำขอที่ต้องอนุมัติ (69ms)
0|server   | 🤖 AutoApproval: Processing all pending requests...

